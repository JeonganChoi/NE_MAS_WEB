{% extends "layouts/base.html" %}

{% block title %} 입/출금 등록 {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
<style>
.btn-outline-warning {
    --bs-btn-hover-color: #F19937;
    --bs-btn-hover-bg: none;
}

#file_name {
    display: flex;
    gap: 10px;
}

#withMainTb .withMainTr_tr.active {
    background-color: lightgoldenrodyellow !important;
}
</style>
{#         style="background-image: url('/static/assets/img/header-blue-purple.jpg'); background-position: bottom;"#}
    <div class="height-100" style="background-image: url('/static/assets/img/header-blue-purple.jpg'); background-position: bottom;"></div>
    <div class="container-fluid py-1 my-2">
        <div class="row mt-n7">
            <div class="col-lg-12">
                <div class="card card-header blur border border-white rounded-2 shadow-xs pb-0">
                    <h6 id="gbn" hidden>{{ request.session.USER_GBN }}</h6>
                    <div class="row">
                        <div class="col-lg-6 col-6 text-start px-3 py-2">
                            <h5 class="text-dark font-weight-bold"><i class="fa fa-credit-card fs-4 me-3"></i>입/출금 등록</h5>
                        </div>
                        <div class="col-lg-6 col-6 text-end px-3 py-2">
                            <button type="button" class="btn btn-sm btn-primary text-white text-sm" id="btnSave" name="btnSave">저 장</button>
                            <button type="button" class="btn btn-sm btn-linkedin text-white text-sm" id="btnClear" name="btnClear">초기화</button>
                            <button type="button" class="btn btn-sm btn-light text-dark text-sm" id="btnDlt" name="btnDlt">삭제</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-8 col-8">
                <div class="card border border-white shadow-xs height-600">
                    <div class="card-header pb-0">
                        <div class="row p-0">
                            <div class="col-lg-5 col-5">
                              <div class="input-group shadow-none">
                                  <label style="font-size: 0.85rem; width: 4rem"><i class="fas fa-search me-2"></i>일자</label>
                                  <input class="form-control border border-light rounded-1 text-center me-2" type="date" name="inputStrDate" id="inputStrDate" style="height: 2rem">
                                  <label class="" style="font-size: 1rem; width: 1rem">-</label>
                                  <input class="form-control border border-light rounded-1 text-center me-2" type="date" name="inputEndDate" id="inputEndDate" style="height: 2rem">
                              </div>
                            </div>
                            <div class="col-lg-3 col-3">
                                <div class="input-group shadow-none">
                                    <label style="font-size: 0.85rem; width: 5rem"><i class="fas fa-search me-2"></i>작성자</label>
                                    <input class="form-control text-start border border-light rounded-1 text-center p-0" type="text" id="inputEmpName" name="inputEmpName" style="height: 2rem; font-size: 0.8rem"/>
                                </div>
                            </div>
                            <div class="col-lg-4 col-4 text-end">
                                 <button type="button" class="btn btn-light ps-3 pe-2 pt-2 pb-2" id="btnClear2" name="btnClear2"><i class="fas fa-delete-left fs-6 me-2"></i></button>
                                 <button type="button" class="btn btn-sm btn-success" id="btnExcel" name="btnExcel"><i class="fas fa-file-excel fs-6 me-2"></i>엑셀</button>
                                 <button type="button" class="btn btn-sm bg-gradient-info" id="btnSearch" name="btnSearch"><i class="fas fa-search fs-6 me-2"></i>조회</button>
                            </div>
                        </div>
                        <div class="row p-0">
                            <div hidden class="col-lg-3 col-3">
                                <div class="input-group shadow-none">
                                    <label style="font-size: 0.85rem; width: 4rem"><i class="fas fa-search me-2"></i>카드명</label>
                                    <select class="form-control border border-light rounded-1 text-center p-0" name="inputCard" id="inputCard" style="font-size: 0.8rem; height: 2rem"></select>
                                </div>
                            </div>
                            <div hidden class="col-lg-3 col-3">
                                <div class="input-group shadow-none">
                                    <label style="font-size: 0.85rem; width: 5rem"><i class="fas fa-search me-2"></i>카드번호</label>
                                    <select class="form-control border border-light rounded-1 text-center p-0" name="inputCardNum" id="inputCardNum" style="font-size: 0.8rem; height: 2rem"></select>
                                </div>
                            </div>
                            <!--<div class="col-lg-3 col-3">
                                <div class="input-group shadow-none">
                                    <label style="font-size: 0.85rem; width: 4rem"><i class="fas fa-search me-2"></i>은행명</label>
                                    <select class="form-control border border-light rounded-1 text-center p-0" name="inputBank" id="inputBank" style="font-size: 0.8rem; height: 2rem"></select>
                                </div>
                            </div>-->
                            <!--<div class="col-lg-4 col-4">
                                <div class="input-group shadow-none">
                                    <label style="font-size: 0.85rem; width: 4rem"><i class="fas fa-search me-2"></i>거래처</label>
                                    <select class="form-control border border-light rounded-1 text-center p-0" name="inputCust" id="inputCust" style="font-size: 0.8rem; height: 2rem"></select>
                                </div>
                            </div>-->
                            <div class="col-lg-3 col-3">
                                <div class="input-group shadow-none">
                                    <label style="font-size: 0.85rem; width: 5rem"><i class="fas fa-search me-2"></i>통장명</label>
                                    <select class="form-control border border-light rounded-1 text-center p-0" name="inputAct" id="inputAct" style="font-size: 0.8rem; height: 2rem"></select>
                                </div>
                            </div>
                            <div class="col-lg-3 col-3">
                                <div class="input-group shadow-none">
                                    <label style="font-size: 0.85rem; width: 5rem"><i class="fas fa-search me-2"></i>거래처</label>
                                    <input hidden class="form-control text-start" type="text" id="inputCust" name="inputCust" style="height: 2rem; font-size: 0.8rem"/>
                                    <input class="form-control text-start border border-light rounded-1 text-center p-0" type="text" id="inputCustName" name="inputCustName" style="height: 2rem; font-size: 0.8rem"/>
                                </div>
                            </div>
                            <div class="col-lg-5 col-5">
                                <div class="d-flex">
                                    <div class="input-group shadow-none pe-3">
                                        <label style="font-size: 0.85rem; width: 5rem"><i class="fas fa-search me-2"></i>결재방법</label>
                                        <select class="form-control border border-light rounded-1 text-center p-0" name="inputPayGbn" id="inputPayGbn" style="font-size: 0.8rem; height: 2rem"></select>
                                    </div>
                                    <div class="input-group shadow-none">
                                        <label style="font-size: 0.85rem; width: 5rem"><i class="fas fa-search me-2"></i>구 분</label>
                                        <select class="form-control border border-light rounded-1 text-center p-0" name="inputGbn" id="inputGbn" style="font-size: 0.8rem; height: 2rem; max-wid">
                                            <option value="" selected> ::선택:: </option>
                                            <option value="1">승인</option>
                                            <option value="2">미승인</option>
                                            <option value="3">시행</option>
                                            <option value="4">미시행</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive-sm height-400 overflow-auto border border-light">
                          <table class="table mb-0 align-items-center justify-content-center" id="grid">
                              <colgroup>
                                  <col width="3%">
                                  <col width="8%">
                                  <col width="6%">
                                  <col width="10%">
                                  <col width="10%">
                                  <col width="4%">
                                  <col width="10%">
                                  <col width="10%">
                                  <col width="10%">
                                  <!--<col width="10%">-->
                                  <col width="8%">
                                  <col width="4%">
                                  <col width="4%">
                              </colgroup>
                            <thead class="text-white font-weight-bolder text-center" style="background-color: rgb(0, 92, 151); position: sticky; top: 0">
                              <tr>
                                <th style="font-size: 0.85rem" class="p-1 excel-hidden">선택</th>
                                <th style="font-size: 0.85rem" class="p-1">사용일자</th>
                                <th style="font-size: 0.85rem" class="p-1">적용년월</th>
                                <th style="font-size: 0.85rem" class="p-1">회계 계정명</th>
                                <th style="font-size: 0.85rem" class="p-1">관리 계정명</th>
                                <th style="font-size: 0.85rem" class="p-1">구 분</th>
                                <th style="font-size: 0.85rem" class="p-1">거래처/사용처</th>
                                <th style="font-size: 0.85rem" class="p-1">입 금</th>
                                <th style="font-size: 0.85rem" class="p-1">출 금</th>
                                <!--<th style="font-size: 0.85rem" class="p-1">잔 액</th>-->
                                <th style="font-size: 0.85rem" class="p-1">통장명</th>
                                <th style="font-size: 0.85rem" class="p-1">결재</th>
                                <th style="font-size: 0.85rem" class="p-1">승인</th>
                              </tr>
                            </thead>
                            <tbody id="withMainTb">
                              <tr id="withMainTr" class="withMainTr_tr">

                              </tr>
                            </tbody>
                          </table>
                        </div>
                        <div class="row mt-2">
                            <div class="col-lg-6 col-6"></div>
                            <div class="col-lg-6 col-6">
                                <div class="d-flex" style="float: right">
                                        <label style="font-size: 0.85rem; width: 3rem"><i class="fa fa-server me-2"></i>총</label>
                                        <input readonly class="form-control border border-light rounded-1 text-end me-2" type="text" name="inputCnt" id="inputCnt" style="font-size: 0.8rem; height: 2rem; max-width: 4rem">
                                        <label class="" style="font-size: 0.85rem; width: 1rem">건</label>
                                        <!--<label style="font-size: 0.85rem; width: 4rem"><i class="fa fa-coins me-2"></i>잔액</label>
                                        <input readonly class="form-control border border-light rounded-1 text-end me-2" type="text" name="inputBal" id="inputBal" style="font-size: 0.8rem; height: 2rem; width: 10rem">-->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 col-4 mb-md-0">
                <div class="card border-0 shadow-xs height-600">
                    <form class="form-control border-0 shadow-none formzone p-0" id="formzone" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="card-body mb-0 pb-0 height-500">
                            <div class="form-group p-0">
                                <div class="row">
                                    <div class="col-4">
                                        <label class="text-sm text-danger"><i class="fa fa-edit me-2"></i>입/출금 구분</label>
                                        <select class="form-control border border-light rounded-1 text-center bg-danger-soft p-1" name="cboWitGbn" id="cboWitGbn" style="height: 2rem; font-size: 0.8rem"></select>
                                    </div>
                                    <div class="col-4 method">
                                        <label class="text-sm"><i class="fa fa-edit me-2"></i>결제방법</label>
                                        <select class="form-control border border-light rounded-1 bg-danger-soft text-center p-1" name="cboWitMethod" id="cboWitMethod" style="height: 2rem; font-size: 0.8rem"></select>
                                    </div>
                                    <div class="col-4">
                                        <i class="fa fa-calendar me-2"></i><label class="text-sm" id="txtRegDate">사용 일자</label>
                                        <input class="form-control text-center rounded-1 bg-danger-soft p-1" type="date" id="txtWitRegDate" name="txtWitRegDate" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-4">
                                        <label class="text-sm"><i class="fa fa-check-square-o me-2 text-dark text-sm"></i>관리계정</label>
                                        <select class="form-control border border-light rounded-1 text-center p-1 bg-danger-soft" name="cboAdminCode" id="cboAdminCode" style="height: 2rem; font-size: 0.8rem"></select>
                                    </div>
                                    <div class="col-8">
                                        <label class="text-sm"><i class="fa fa-edit me-2"></i>제 목</label>
                                        <input class="form-control text-start bg-danger-soft" type="text" id="txtTitle" name="txtTitle" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group p-0 mt-4 basic">
                                <div class="row">
                                    <div class="col-4 txtUser">
                                        <label class="text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>사용처</label>
                                        <input class="form-control text-start" type="text" id="txtWhere" name="txtWhere" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                    <div class="col-4 cboCust">
                                        <label class="text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>거래처</label>
                                        <input hidden class="form-control text-start" type="text" id="cboWitCust" name="cboWitCust" style="height: 2rem; font-size: 0.8rem"/>
                                        <input class="form-control text-start" type="text" id="txtCustName" name="txtCustName" style="height: 2rem; font-size: 0.8rem"/>
                                        <!--<select class="form-control text-center p-1" name="cboWitCust" id="cboWitCust" style="height: 2rem; font-size: 0.8rem"></select>-->
                                    </div>
                                    <div class="col-4">
                                        <label class="text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>금액</label>
                                        <input class="form-control text-end" type="text" id="txtWitPrice" name="txtWitPrice" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                    <div class="col-3 checkPre">
                                        <div class="d-flex">
                                            <label class="text-sm mt-1 me-3"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>선지급</label>
                                            <input class="" type="checkbox" id="chkPre" name="chkPre" value="Y" style="font-size: 0.8rem"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-4 cboBank">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>은행</label>
                                        <select class="form-control border border-light rounded-1 text-center p-1" name="cboBank" id="cboBank" style="height: 2rem; font-size: 0.8rem"></select>
                                    </div>
                                    <div class="col-4" hidden>
                                        <label class="text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>거래처은행</label>
                                        <input class="form-control text-start" type="text" id="txtCustBank" name="txtCustBank" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                    <div class="col-4" hidden>
                                        <label class="text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>거래처계좌번호</label>
                                        <input class="form-control text-start" type="text" id="txtCustAct" name="txtCustAct" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                    <div class="col-4 cardName">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>카드 명</label>
                                        <select class="form-control border border-light rounded-1 text-center p-1" name="cboCardName" id="cboCardName" style="height: 2rem; font-size: 0.8rem"></select>
                                    </div>
                                    <div class="col-4 cboCard">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>카드 번호</label>
                                        <select class="form-control border border-light rounded-1 text-center p-1" name="cboWitCard" id="cboWitCard" style="height: 2rem; font-size: 0.8rem"></select>
                                    </div>
                                    <div class="col-4 cboAct">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>계좌번호</label>
                                        <select class="form-control border border-light rounded-1 text-center p-1" name="cboWitActNum" id="cboWitActNum" style="height: 2rem; font-size: 0.8rem"></select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div hidden class="col-4">
                                        <input class="form-control text-end" type="number" id="txtWitSeq" name="txtWitSeq"/>
                                        <input class="form-control text-end" type="number" id="txtWitRecn" name="txtWitRecn"/>
                                    </div>
                                </div>
                                <div class="row mt-2 txtDate">
                                    <div class="col-4 txtApply">
                                        <label class="text-sm"><i class="far fa-calendar me-2" style="font-size: 0.7rem"></i>적용 년월</label>
                                        <input class="form-control text-center" type="month" id="txtApplyDate" name="txtApplyDate" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                    <div class="col-4 txtExpect">
                                        <label class="text-sm" id="dateLabel"><i class="fa fa-calendar me-2" style="font-size: 0.7rem"></i>결재 예정 일자</label>
                                        <input class="form-control text-center" type="date" id="txtExDate" name="txtExDate" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-6">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>세부 내용</label>
                                        <input class="form-control text-start" type="text" id="txtWitRemark" name="txtWitRemark" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-6 writer">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>수령인 정보</label>
                                        <input class="form-control text-start" type="text" id="txtInfo" name="txtInfo" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                    <div class="col-6 cashDate">
                                        <label class="mt-2 text-sm" id="dateLabel"><i class="fa fa-calendar me-2" style="font-size: 0.7rem"></i>지급요청일</label>
                                        <input class="form-control text-center" type="date" id="txtCashDate" name="txtCashDate" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="mt-2 col-4 creUser">
                                        <label class="text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>등록자</label>
                                        <input class="form-control text-start bg-primary-soft text-dark" type="text" id="txtCreUser" name="txtCreUser" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group replace">
                                <div class="row">
                                    <div class="col-4">
                                        <label class="text-sm"><i class="fa fa-calendar me-2" style="font-size: 0.7rem"></i>등록 일자</label>
                                        <input class="form-control text-center" type="date" id="txtWitRegDate2" name="txtWitRegDate2" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-4">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>출금 은행</label>
                                        <select class="form-control border border-light rounded-1 text-center p-1" name="cboOutBank" id="cboOutBank" style="height: 2rem; font-size: 0.8rem"></select>
                                    </div>
                                    <div class="col-6">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>출금 계좌 번호</label>
                                        <select class="form-control border border-light rounded-1 text-center p-1" name="cboOutAct" id="cboOutAct" style="height: 2rem; font-size: 0.8rem"></select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-4">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>입금 은행</label>
                                        <select class="form-control border border-light rounded-1 text-center p-1" name="cboInBank" id="cboInBank" style="height: 2rem; font-size: 0.8rem"></select>
                                    </div>
                                    <div class="col-6">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>입금 계좌 번호</label>
                                        <select class="form-control border border-light rounded-1 text-center p-1" name="cboInAct" id="cboInAct" style="height: 2rem; font-size: 0.8rem"></select>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-4">
                                        <i class="far fa-calendar me-2" style="font-size: 0.7rem"></i><label class="mt-2" id="dateLabel">대체 일자</label>
                                        <input class="form-control text-center" type="date" id="txtOffDate" name="txtOffDate" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                    <div class="col-6">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2"></i>금액</label>
                                        <input class="form-control text-end" type="number" id="txtWitPrice2" name="txtWitPrice2" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                    <div hidden class="col-4">
                                        <input class="form-control text-end" type="number" id="txtWitSeq2" name="txtWitSeq2"/>
                                        <input class="form-control text-end" type="number" id="txtWitRecn2" name="txtWitRecn2"/>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-8">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2"></i>내용</label>
                                        <input class="form-control text-start" type="text" id="txtWitRemark2" name="txtWitRemark2" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                    <div class="col-4 creUser">
                                        <label class="mt-2 text-sm"><i class="fa fa-edit me-2" style="font-size: 0.7rem"></i>등록자</label>
                                        <input class="form-control text-start bg-primary-soft text-dark" type="text" id="txtCreUser" name="txtCreUser" style="height: 2rem; font-size: 0.8rem"/>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <div class="card-footer mt-0 pt-0">
                            <div class="row mt-3">
                                <div class="col-12 text-start line">
                                    <label class="form-label" id="lineLabel"><i class="fas fa-pen me-2"></i>내부 결재 지정</label>
                                    <div class="form-group mt-2 mb-0">
                                        <div class="row">
                                            <div class="col-12 text-start">
                                                <div class="d-flex">
                                                    <button type="button" class="btn btn-sm btn-dark me-3" style="width: 10vw" id="btnDst" name="btnDst" data-bs-toggle='modal' data-bs-target='#DecisionModal'>내부 결재</button>
                                                    {% if request.session.USER_GBN != '3' %}
                                                    <button type="button" class="btn btn-sm btn-warning btnApv" style="width: 10vw" id="btnApv" name="btnApv" value="">전결</button>
                                                    {% endif %}
                                                </div>
                                            </div>
                                            <div hidden class="col-12 text-start">
                                                <input readonly class="form-control border-0 shadow-none bg-transparent" type="text" id="txtApvAll"  name="txtApvAll" style="font-size: 1rem"/>
                                                <input readonly class="form-control border-0 text-danger shadow-none bg-transparent" type="text" id="warning"  name="warning" style="font-size: 1rem"/>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="table-responsive-sm overflow-auto bg-transparent">
                                        <table class="table mb-0 border-0 text-white align-items-center justify-content-center" id="signTb">
                                          <tbody class="bg-transparent text-center border-0 text-white" id="signTd">

                                          </tbody>
                                        </table>
                                    </div>
                                    <div id="file_name"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12 text-start">
                                    <div class="form-group apvArea">
                                        <label class="form-label"><i class="fas fa-users-line me-2"></i>결재 라인</label>
                                        <div class="table-responsive-sm border border-warning overflow-auto m-0">
                                            <table class="table mb-0 align-items-center justify-content-center">
                                                <tbody id="subTb">
                                                <tr id="#subTr" class="subTr_tr">
                                                </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-12 text-start">
                                    <div class="form-group folderArea">
                                    <!--<div class="col-6 text-start">
                                        <label class="mt-4 form-label">Starting Files</label>
                                        <form action="/file-upload" class="form-control dropzone" id="dropzone">
                                          <div class="fallback">
                                            <input class="" name="file" type="file" multiple/>
                                          </div>
                                        </form>
                                    </div>-->
                                        <label class="form-label"><i class="fas fa-image me-2"></i>증빙서류 등록</label>
                                        <input type="hidden" id="fileListInput" value="[]" />
                                        <div id="fileList">

                                        </div>
                                        <a class="btn btn-outline-primary btn-sm" type="button" id="addFileInputBtn">파일 추가</a>
                                        <!--<input name="file" id="file" type="file" class="" style="display: none;" multiple/>
                                        <div class="form-group text-start">
                                            <a class="btn btn-outline-dark btn-sm" type="button" id="btnFile">파일 선택</a>
                                            <a class="btn btn-outline-danger btn-sm" type="button" id="btnFileLook">파일 보기</a>
                                        </div>-->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>



<!-- Modal -->
    <div class="modal fade" id="DecisionModal" tabindex="-1" role="dialog" aria-labelledby="DecisionModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document" style="min-width: 40vw">
            <div class="modal-content">
                <form method="post">
                    {% csrf_token %}
                    <div class="modal-header bg-dark" style="height: 5vh">
                        <a class="text-white" type="button" id="btnClose" name="btnClose" style="float:right;"><i class="fa fa-xmark fs-6"></i></a>
                    </div>
                    <div class="modal-body">
                        <div class="row p-2">
                            <div class="col-6">
                                <div class="row">
                                    <div class="col-4 text-start"><h6 class="text-sm"><i class="fas fa-grip-lines me-2"></i>결재선 지정</h6></div>
                                    <div class="col-8 text-end">
                                        <div class="form-group">
                                            <label class="text-sm me-2">부 서</label>
                                            <select class="border border-light rounded-1 text-center" name="cboDpt" id="cboDpt" style="height: 1.5rem; font-size: 0.8rem; width: 8rem"></select>
                                        </div>
                                    </div>
                                </div>
                                <div class="table-responsive-sm overflow-auto border border-light height-300">
                                  <table class="table mb-0 align-items-center justify-content-center" id="modalMainTb">
                                      <colgroup>
                                          <col width="3%">
                                          <col width="10%">
                                          <col width="10%">
                                          <col width="10%">
                                      </colgroup>
                                    <thead class="text-white font-weight-bolder text-center bg-primary">
                                      <tr>
                                        <th style="font-size: 0.8rem" class="p-1">선 택</th>
                                        <th style="font-size: 0.8rem" class="p-1">부 서</th>
                                        <th style="font-size: 0.8rem" class="p-1">직 책</th>
                                        <th style="font-size: 0.8rem" class="p-1">이 름</th>
                                      </tr>
                                    </thead>
                                    <tbody id="modalMainTd">
                                      <tr id="#modalMainTr" class="modalMainTr_tr">

                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                            </div>
                            <div class="col-1"></div>
                            <div class="col-5">
                                <h6 class="text-sm"><i class="fas fa-file-signature me-2"></i>결재 라인</h6>
                                <div class="table-responsive-sm overflow-auto border border-light height-300 mt-4">
                                  <table class="table mb-0 align-items-center justify-content-center" id="modalSubTb">
                                      <colgroup>
                                          <col hidden width="10%">
                                          <col hidden width="10%">
                                          <col hidden width="10%">
                                          <col width="3%">
                                          <col width="10%">
                                          <col width="10%">
                                      </colgroup>
                                    <thead class="text-white font-weight-bolder text-center bg-gray-700">
                                      <tr>
                                        <th hidden style="font-size: 0.8rem" class="p-1">부 서</th>
                                        <th hidden style="font-size: 0.8rem" class="p-1">직 책</th>
                                        <th hidden style="font-size: 0.8rem" class="p-1">사 번</th>
                                        <th style="font-size: 0.8rem" class="p-1">순번</th>
                                        <th style="font-size: 0.8rem" class="p-1">Seg</th>
                                        <th style="font-size: 0.8rem" class="p-1">이 름</th>
                                      </tr>
                                    </thead>
                                    <tbody id="modalSubTd">
                                    </tbody>
                                  </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer text-end border-0">
                        <button type="button" class="btn btn-sm btn-warning text-white font-weight-bolder" id="btnSave2" name="btnSave2" style="width: 10vw">확 인</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

{% endblock %}

{% block javascripts %}

    <script>
{#       드롭존  #}
        Dropzone.autoDiscover = false;
        var drop = document.getElementById('dropzone')
        var myDropzone = new Dropzone(drop, {
            url: "/file/post",
            addRemoveLinks: true

        });

    </script>

    <script>
        var _flag = false;


        //파일선택창에서 이미지 선택 후 확인 누르면 그 동시에 발생하는 이벤트
        $('#file').change(function(event) {
            var file = event.target.files[0]

            var reader = new FileReader(); //1

            reader.onload = function(e) {
                $('#itemimage').attr('src', e.target.result); //3
            }

            reader.readAsDataURL(file); //2
        });

        $(document).on('click', '#btnDst', function () {

            var chk_cust_id_arr = [];
            var cboDpt = "";
            var cboDptTxt = "<option value=''>:: 선택 ::</option>";

            var empArr = [];
            var ioDate = $('#txtWitRegDate').val();
            var acIogb = $('#cboWitGbn').val();
            var acSeq = $('#txtWitSeq').val();
            var mCode = $('#cboAdminCode').val();

            $("#cboDpt").html("");

            if(_flag == false) {
                $.ajax({
                    type: "post",
                    data: {
                        'empList': JSON.stringify(chk_cust_id_arr),
                        "cboDpt": cboDpt,
                        {#'ioDate': ioDate,#}
                        {#'acIogb': acIogb,#}
                        {#'acSeq': acSeq,#}
                        {#'mCode': mCode,#}
                    },
                    url: '{% url "apvLine_modal" %}',
                    headers: {
                        'X-CSRFTOKEN': '{{ csrf_token }}'
                    },
                    dataType: 'json',
                    success: function (data) {
                        _flag = true;

                        var list = data.mainList;

                        $("#modalMainTd").html("");

                        for (var i = 0; i < list.length; i++) {

                            $("#modalMainTd").append(
                                "<tr id='#modalMainTr' class='modalMainTr_tr'>" +
                                "<td class='text-center p-1' style='font-size: 0.8rem'><input class='' type='checkbox' id='chkEmp_" + list[i][4] + "' name='chkEmp[]' value='" + list[i][0] + "," + list[i][2] + "," + list[i][4] + "'/></td>" +
                                "<td hidden class='text-start p-1' style='font-size: 0.8rem'>" + list[i][0] + "</td>" +
                                "<td class='text-start p-1' style='font-size: 0.8rem'>" + list[i][1] + "</td>" +
                                "<td hidden class='text-start p-1' style='font-size: 0.8rem'>" + list[i][2] + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.8rem'>" + list[i][3] + "</td> " +
                                "<td hidden class='text-start p-1' style='font-size: 0.8rem'>" + list[i][4] + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.8rem'>" + list[i][5] + "</td> " +
                                "</tr> ");
                        }

                        $('.subEmpNme').each(function() {
                            const code = $(this).data('code');
                            $(`#chkEmp_${code}`).trigger('click');
                        });


                        var combolist = data.cboDpt;
                        for (var i = 0; i < combolist.length; i++) {
                            if (combolist[i][0] == cboDpt) {
                                cboDptTxt = cboDptTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][1] + "</option>";
                            } else {
                                cboDptTxt = cboDptTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][1] + "</option>";
                            }
                        }

                        $("#cboDpt").append(cboDptTxt);
                    }
                })
            }

            $('#DecisionModal').show();
        });

        {# 부서 선택시 계좌명 바인딩 #}
        $('#cboDpt').change(function () {

            var chk_cust_id_arr = [];
            var cboDpt = document.getElementById('cboDpt').value;

            $.ajax({
                type: "post",
                data: {
                    'empList': JSON.stringify(chk_cust_id_arr),
                    "cboDpt": cboDpt,
                },
                url: '{% url "apvLine_modal" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {
                    var list = data.mainList;

                    $("#modalMainTd").html("");

                    for (var i = 0; i < list.length; i++) {

                        $("#modalMainTd").append(
                            "<tr id='#modalMainTr' class='modalMainTr_tr'>" +
                            "<td class='text-center p-1' style='font-size: 0.8rem'><input class='' type='checkbox' id='chkEmp[]' name='chkEmp[]' value='" + list[i][0] + "," + list[i][2] + "," + list[i][4] + "'/></td>" +
                            "<td hidden class='text-start p-1' style='font-size: 0.8rem'>" + list[i][0] + "</td>" +
                            "<td class='text-start p-1' style='font-size: 0.8rem'>" + list[i][1] + "</td>" +
                            "<td hidden class='text-start p-1' style='font-size: 0.8rem'>" + list[i][2] + "</td> " +
                            "<td class='text-start p-1' style='font-size: 0.8rem'>" + list[i][3] + "</td> " +
                            "<td hidden class='text-start p-1' style='font-size: 0.8rem'>" + list[i][4] + "</td> " +
                            "<td class='text-start p-1' style='font-size: 0.8rem'>" + list[i][5] + "</td> " +
                            "</tr> ");
                    }
                }
            })

        });

        $(document).on('change', '#modalMainTb tbody tr td:first-child input[type=checkbox]', function() {
            var tr = $(this).parent().parent();
            var empDpt = tr.children().eq(1).text()
            var empGbn = tr.children().eq(3).text()
            var empNbr = tr.children().eq(5).text()
            var empNme = tr.children().eq(6).text()

            if($(this).is(':checked')) {
                if($('#modalSubTr' + empNbr).length == 0) {

                    var sub_tr_cnt = $('#modalSubTb tbody tr').length;
                    var seq = parseInt(sub_tr_cnt) + 1

                    $("#modalSubTd").append(
                        "<tr id='modalSubTr" + empNbr + "' class='modalSubTr_tr'>" +
                        "<td hidden class='text-start p-1 empDpt' id='empDpt_" + (sub_tr_cnt) + "' style='font-size: 0.8rem'>" + empDpt + "</td>" +
                        "<td hidden class='text-start p-1 empGbn' id='empGbn_" + (sub_tr_cnt) + "' style='font-size: 0.8rem'>" + empGbn + "</td> " +
                        "<td hidden class='text-start p-1 empNbr' name='empNbr' id='empNbr_" + (sub_tr_cnt) + "' style='font-size: 0.8rem'>" + empNbr + "</td> " +
                        "<td class='text-start p-1' style='font-size: 0.8rem'>" + seq + "</td> " +
                        "<td class='text-start p-1'  id='empNbr_" + (sub_tr_cnt) + "' style='font-size: 0.8rem'>" + empNbr + "</td> " +
                        "<td class='text-start p-1 empNme' id='empNme_" + (sub_tr_cnt) + "' style='font-size: 0.8rem'>" + empNme + "</td> " +
                        "</tr> ");

                }
            } else {
                $('#modalSubTr' + empNbr).remove();
            }
        });

        {# close 버튼 클릭시 #}
        $(document).on('click', '#btnClose', function () {
            $('#DecisionModal').modal('hide');
        });


        {# 확인 버튼 클릭시 #}
        $(document).on('click', '#btnSave2', function () {

            {#var saveresult = confirm("결재라인을 지정하시겠습니까?")#}

            const tbRow = $('#modalSubTd tr');

            var empArr = [];
            tbRow.each(function() {
                var empDpt = $(this).find('.empDpt').text();
                var empGbn = $(this).find('.empGbn').text();
                var empNbr = $(this).find('.empNbr').text();
                var empNme = $(this).find('.empNme').text();

                let data = {
                    'empDpt': empDpt,
                    'empGbn': empGbn,
                    'empNbr': empNbr,
                    'empNme': empNme
                };

                empArr.push(data);
            });


            $("#signTd").html("");
            $("#signTd").append("<tr id='signTdTr' class='signTdTr_tr'>" + + " </tr>" );
            for (var i = 0; i < empArr.length; i++) {

                $("#signTd").append(
                    "<td hidden id='signTdTr" + empArr[i][2] + "' class='signTdTr_tr'></td>" +
                    "<td hidden class='text-center p-1' id='subSeq_" + i + "' style='font-size: 0.8rem'>" + i + "</td>" +
                    "<td hidden class='text-center p-1' id='subEmpDpt_" + i + "' style='font-size: 0.8rem'>" + empArr[i].empDpt + "</td>" +
                    "<td hidden class='text-center p-1' id='subEmpGbn_" + i + "' style='font-size: 0.8rem'>" + empArr[i].empGbn + "</td>" +
                    "<td hidden class='text-center p-1' id='subEmpNbr_" + i + "' style='font-size: 0.8rem'>" + empArr[i].empNbr + "</td>" +
                    "<td class='text-start p-1 border border-white' id='subEmpNme_" + i + "' style='font-size: 0.8rem'>" + empArr[i].empNme + "</td>");
            }

            $('#DecisionModal').modal('hide');


        });

    </script>

    <script>
        {#  화면뜰때 #}
        $(document).ready(function () {
            // 파일 빈 배열 추가
            var _arr = new Array(5).fill('');
            $('#fileListInput').val(JSON.stringify(_arr));

            var inputBank = "";
            var inputPayGbn = "";
            var cboCust = "";
            var cboAct = "";
            var inputCard = "";
            var inputCardNum = "";
            var cboWitCust2 = "";
            var cboWitGbn = "";
            var cboAdminCode = "";
            var cboWitMethod = "";
            var cboWitActNum = "";
            var cboWitCard = "";
            var cboBank = "";
            var cboCardName = "";
            var inputPayGbnTxt = "<option value=''>:: 선택 ::</option>";
            var inputCardTxt = "<option value=''>:: 선택 ::</option>";
            var inputCardNumTxt = "<option value=''>:: 선택 ::</option>";
            var inputBankTxt = "<option value=''>:: 선택 ::</option>";
            var cboCustTxt = "<option value=''>:: 선택 ::</option>";
            var cboActTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitCustTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitGbnTxt = "";
            var cboAdminCodeTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitMethodTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitActNumTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitCardTxt = "<option value=''>:: 선택 ::</option>";
            var cboBankTxt = "<option value=''>:: 선택 ::</option>";
            var cboCardNameTxt = "<option value=''>:: 선택 ::</option>";

            {#$("#inputCust").html("");#}
            $('.apvArea').hide();
            $("#inputCard").html("");
            $("#inputPayGbn").html("");
            $("#inputEmpName").val("");
            $("#inputCardNum").html("");
            $("#inputActName").html("");
            $("#inputAct").html("");
            $("#inputCust").html("");
            $("#inputCustName").html("");
            $("#cboWitCust").html("");
            $("#cboWitGbn").html("");
            $("#cboAdminCode").html("");
            $("#cboWitMethod").html("");
            $("#cboWitActNum").html("");
            $("#cboWitCard").html("");
            $("#cboBank").html("");
            $("#cboCardName").html("");
            $("#txtWitRegDate").val("");
            $("#txtWitSeq").val("");
            $("#txtWitRecn").val("");
            $("#txtWitPrice").val("");
            $("#txtWitCashNum").val("");
            $("#txtWitRemark").val("");
            $("#txtCashDate").val("");

            $('.basic').hide();
            $('.replace').hide();
            $('.cardName').hide();
            $('.cboBank').hide();
            $('.cboAct').hide();
            $('.cboCard').hide();
            $('.creUser').hide();
            $('#addFileInputBtn').show();

            var date = new Date();
            date.setMonth(date.getMonth() - 3);

            document.getElementById("inputStrDate").valueAsDate = date;
            document.getElementById("inputEndDate").valueAsDate = new Date;
            document.getElementById("txtWitRegDate").valueAsDate = new Date;

            var acIogb = "";
            var acDate = "";
            var acNum = "";
            var acCust = "";
            var acMcode = "";
            var cboGbn = "1";

            let data2 = {
                "acIogb": acIogb,
                "acDate": acDate,
                "acNum": acNum,
                "acCust": acCust,
                "acMcode": acMcode,
                "cboGbn": cboGbn,
            }

            $.ajax({
                type: "post",
                data: data2,
                url: '{% url "payment_search" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {

                    var combolist = data.cboCust;
                    for (var i = 0; i < combolist.length; i++) {
                        if (combolist[i][0] == cboWitCust2) {
                            cboWitCustTxt = cboWitCustTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][1] + "</option>";
                        } else {
                            cboWitCustTxt = cboWitCustTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][1] + "</option>";
                        }
                    }

                    var combolist2 = data.cboGgn;
                    for (var i = 0; i < combolist2.length; i++) {
                        if (combolist2[i][0] == cboWitGbn) {
                            cboWitGbnTxt = cboWitGbnTxt + "<option value='" + combolist2[i][0] + "' selected>" + combolist2[i][1] + "</option>";
                        } else {
                            cboWitGbnTxt = cboWitGbnTxt + "<option value='" + combolist2[i][0] + "'>" + combolist2[i][1] + "</option>";
                        }
                    }

                    var combolist3 = data.cboPay;
                    for (var i = 0; i < combolist3.length; i++) {
                        if (combolist3[i][0] == cboWitMethod) {
                            cboWitMethodTxt = cboWitMethodTxt + "<option value='" + combolist3[i][0] + "' selected>" + combolist3[i][1] + "</option>";
                        } else {
                            cboWitMethodTxt = cboWitMethodTxt + "<option value='" + combolist3[i][0] + "'>" + combolist3[i][1] + "</option>";
                        }
                    }

                    var combolist11 = data.cboPay;
                    for (var i = 0; i < combolist11.length; i++) {
                        if (combolist11[i][0] == inputPayGbn) {
                            inputPayGbnTxt = inputPayGbnTxt + "<option value='" + combolist11[i][0] + "' selected>" + combolist11[i][1] + "</option>";
                        } else {
                            inputPayGbnTxt = inputPayGbnTxt + "<option value='" + combolist11[i][0] + "'>" + combolist11[i][1] + "</option>";
                        }
                    }

                    var combolist4 = data.cboMCode;
                    for (var i = 0; i < combolist4.length; i++) {
                        if (combolist4[i][0] == cboAdminCode) {
                            cboAdminCodeTxt = cboAdminCodeTxt + "<option value='" + combolist4[i][0] + "' selected>" + combolist4[i][1] + "</option>";
                        } else {
                            cboAdminCodeTxt = cboAdminCodeTxt + "<option value='" + combolist4[i][0] + "'>" + combolist4[i][1] + "</option>";
                        }
                    }

                    var combolist5 = data.cboAcnumber;
                    for (var i = 0; i < combolist5.length; i++) {
                        if (combolist5[i][0] == cboWitActNum) {
                            cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "' selected>" + combolist5[i][0] + "</option>";
                        } else {
                            cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "'>" + combolist5[i][0] + "</option>";
                        }
                    }

                    var combolist6 = data.cboCard;
                    for (var i = 0; i < combolist6.length; i++) {
                        if (combolist6[i][0] == cboWitCard) {
                            cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist6[i][0] + "' selected>" + combolist6[i][0] + "</option>";
                        } else {
                            cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist6[i][0] + "'>" + combolist6[i][0] + "</option>";
                        }
                    }

                    var combolist7 = data.cboBank;
                    for (var i = 0; i < combolist7.length; i++) {
                        if (combolist7[i][0] == cboBank) {
                            cboBankTxt = cboBankTxt + "<option value='" + combolist7[i][0] + "' selected>" + combolist7[i][1] + "</option>";
                        } else {
                            cboBankTxt = cboBankTxt + "<option value='" + combolist7[i][0] + "'>" + combolist7[i][1] + "</option>";
                        }
                    }

                    var combolist8 = data.cardName;
                    for (var i = 0; i < combolist8.length; i++) {
                        if (combolist8[i][0] == cboCardName) {
                            cboCardNameTxt = cboCardNameTxt + "<option value='" + combolist8[i][0] + "' selected>" + combolist8[i][1] + "</option>";
                        } else {
                            cboCardNameTxt = cboCardNameTxt + "<option value='" + combolist8[i][0] + "'>" + combolist8[i][1] + "</option>";
                        }
                    }

                    var combolist9 = data.cardName;
                    for (var i = 0; i < combolist9.length; i++) {
                        if (combolist9[i][0] == inputCard) {
                            inputCardTxt = inputCardTxt + "<option value='" + combolist9[i][0] + "' selected>" + combolist9[i][1] + "</option>";
                        } else {
                            inputCardTxt = inputCardTxt + "<option value='" + combolist9[i][0] + "'>" + combolist9[i][1] + "</option>";
                        }
                    }

                    var combolist10 = data.cboCard;
                    for (var i = 0; i < combolist10.length; i++) {
                        if (combolist10[i][0] == inputCardNum) {
                            inputCardNumTxt = inputCardNumTxt + "<option value='" + combolist10[i][0] + "' selected>" + combolist10[i][1] + "</option>";
                        } else {
                            inputCardNumTxt = inputCardNumTxt + "<option value='" + combolist10[i][0] + "'>" + combolist10[i][1] + "</option>";
                        }
                    }

                    $("#inputPayGbn").append(inputPayGbnTxt);
                    $("#inputCard").append(inputCardTxt);
                    $("#inputCardNum").append(inputCardNumTxt);
                    $("#cboWitCust").append(cboWitCustTxt);
                    $("#cboWitGbn").append(cboWitGbnTxt);
                    $("#cboWitMethod").append(cboWitMethodTxt);
                    $("#cboAdminCode").append(cboAdminCodeTxt);
                    $("#cboWitActNum").append(cboWitActNumTxt);
                    $("#cboWitCard").append(cboWitCardTxt);
                    $("#cboBank").append(cboBankTxt);
                    $("#cboCardName").append(cboCardNameTxt);
                }
            })

            var sDate = document.getElementById('inputStrDate').value;
            var eDate = document.getElementById('inputEndDate').value;
            var cboAct = document.getElementById('inputAct').value;
            var cboCust = document.getElementById('inputCust').value;
            var empName = "";
            var payGbn = "";
            var Gbn = "";

            var strDate = sDate.replace(/\-/g, '')
            var endDate = eDate.replace(/\-/g, '')

            let data = {"strDate": strDate, "endDate": endDate, "cboAct": cboAct, "cboCust": cboCust, "empName": empName, "payGbn": payGbn, "Gbn": Gbn}

            $.ajax({
                type: "post",
                data: data,
                url: '{% url "receivePay_search" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {
                    var list = data.mainList;
                    var list2 = data.balList;
                    var outTotal = data.outresult;
                    var inTotal = data.inresult;
                    var total = 0;
                    var apv = "";
                    var cust = "";
                    var chkOpt = "";
                    var count = 0;
                    count = list.length;

                    $("#withMainTb").html("");
                    {# 잔액 계산 #}
                    {#if(list2 != ''){#}
                    {#    for (var i = 0; i < list2.length; i++) {#}
                    {#        total = list2[0][3]#}
                    {#        $("#withMainTb").append(#}
                    {#            "<tr id='#withMainTr' class='withMainTr_tr'>" +#}
                    {#            "<td hidden class='text-center p-1' style='font-size: 0.85rem'></td>" +#}
                    {#            "<td class='text-center p-1' style='font-size: 0.85rem'></td>" +#}
                    {#            "<td class='text-center p-1' style='font-size: 0.85rem'>잔 액</td>" +#}
                    {#            "<td class='text-center p-1' style='font-size: 0.85rem'></td>" +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-end p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "</tr> ");#}
                    {#    }#}
                    {#}#}

                    if(list2 != ''){
                        for (var i = 0; i < list.length; i++) {

                            {# 입금 #}
                            if (list[i][0] == '2') {
                                total += list[i][2]
                            }
                            {# 출금 #}
                            if (list[i][0] == '1') {
                                total -= list[i][3]
                            }
                            var check = "";
                            if(list[i][9] == 'Y' ){
                                check = '시행';
                            }
                            if(list[i][9] == 'N'){
                                check = '미시행';
                            }
                            if(list[i][21] == 'Y' ){
                                apv = '승인';
                            }
                            if(list[i][21] == 'R'){
                                apv = '반려';
                            }
                            if(list[i][21] == 'N' && list[i][24] != ''){
                               apv = list[i][24];
                            }
                            if(list[i][21] == 'N' && list[i][24] == ''){
                               apv = '미승인';
                            }
                            if(list[i][18] == '2'){
                                cust = list[i][5]
                            }
                            if(list[i][18] == '1' || list[i][18] == '3' || list[i][18] == '4'){
                                cust = list[i][22]
                            }

                            if(list[i][9] == 'Y'){
                                $("#withMainTb").append(
                                    "<tr id='#withMainTr' class='withMainTr_tr excel-hidden' main_code='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'>" +
                                    "<td hidden class='text-center p-1 excel-hidden' style='font-size: 0.85rem'>" + list[i][0] + "</td>" +
                                    "<td class='text-center p-1 excel-hidden' style='font-size: 0.8rem'><input disabled class='' type='checkbox' id='chkWith[]' name='chkWith[]' value='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'/></td>" +
                                    "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][1].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3') + "</td>" +
                                    "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][17].replace(/(\d{4})(\d{2})/g, '$1-$2') + "</td>" +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][14] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][10] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][16] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + cust + "</td> " +
                                    "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][2]) + "</td> " +
                                    "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][3]) + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][7] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + apv + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + check + "</td> " +
                                    "<td hidden class='text-start p-1' style='font-size: 0.85rem'>" + list[i][12] + "</td> " +
                                    "</tr> ");
                            }
                            else{
                                $("#withMainTb").append(
                                    "<tr id='#withMainTr' class='withMainTr_tr excel-hidden' main_code='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'>" +
                                    "<td hidden class='text-center p-1 excel-hidden' style='font-size: 0.85rem'>" + list[i][0] + "</td>" +
                                    "<td class='text-center p-1 excel-hidden' style='font-size: 0.8rem'><input onclick='checkOnlyOne(this)' class='' type='checkbox' id='chkWith[]' name='chkWith[]' value='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'/></td>" +
                                    "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][1].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3') + "</td>" +
                                    "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][17].replace(/(\d{4})(\d{2})/g, '$1-$2') + "</td>" +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][14] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][10] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][16] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + cust + "</td> " +
                                    "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][2]) + "</td> " +
                                    "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][3]) + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][7] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + apv + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + check + "</td> " +
                                    "<td hidden class='text-start p-1' style='font-size: 0.85rem'>" + list[i][12] + "</td> " +
                                    "</tr> ");
                            }
                        }


                        {#total = addComma(total)#}
                        {#document.getElementById("inputBal").value = total;#}
                        document.getElementById("inputCnt").value = count;
                    }
                    if(list2 == ''){

                        for (var i = 0; i < list.length; i++) {

                            var check = "";
                            if(list[i][9] == 'Y' ){
                                check = '시행';
                            }
                            if(list[i][9] == 'N'){
                                check = '미시행';
                            }
                            if(list[i][21] == 'Y' ){
                                apv = '승인';
                            }
                            if(list[i][21] == 'R'){
                                apv = '반려';
                            }
                            if(list[i][21] == 'N' && list[i][24] != ''){
                               apv = list[i][24];
                            }
                            if(list[i][21] == 'N' && list[i][24] == ''){
                               apv = '미승인';
                            }
                            if(list[i][18] == '2'){
                                cust = list[i][5]
                            }
                            if(list[i][18] == '1' || list[i][18] == '3' || list[i][18] == '4'){
                                cust = list[i][22]
                            }

                            if(list[i][9] == 'Y'){
                                $("#withMainTb").append(
                                    "<tr id='#withMainTr' class='withMainTr_tr excel-hidden' main_code='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'>" +
                                    "<td hidden class='text-center p-1 excel-hidden' style='font-size: 0.85rem'>" + list[i][0] + "</td>" +
                                    "<td class='text-center p-1 excel-hidden' style='font-size: 0.8rem'><input disabled class='' type='checkbox' id='chkWith[]' name='chkWith[]' value='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'/></td>" +
                                    "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][1].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3') + "</td>" +
                                    "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][17].replace(/(\d{4})(\d{2})/g, '$1-$2') + "</td>" +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][14] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][10] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][16] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + cust + "</td> " +
                                    "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][2]) + "</td> " +
                                    "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][3]) + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][7] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + apv + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + check + "</td> " +
                                    "<td hidden class='text-start p-1' style='font-size: 0.85rem'>" + list[i][12] + "</td> " +
                                    "</tr> ");
                            }
                            else{
                                $("#withMainTb").append(
                                    "<tr id='#withMainTr' class='withMainTr_tr excel-hidden' main_code='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'>" +
                                    "<td hidden class='text-center p-1 excel-hidden' style='font-size: 0.85rem'>" + list[i][0] + "</td>" +
                                    "<td class='text-center p-1 excel-hidden' style='font-size: 0.8rem'><input onclick='checkOnlyOne(this)' class='' type='checkbox' id='chkWith[]' name='chkWith[]' value='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'/></td>" +
                                    "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][1].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3') + "</td>" +
                                    "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][17].replace(/(\d{4})(\d{2})/g, '$1-$2') + "</td>" +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][14] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][10] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][16] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + cust + "</td> " +
                                    "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][2]) + "</td> " +
                                    "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][3]) + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][7] + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + apv + "</td> " +
                                    "<td class='text-start p-1' style='font-size: 0.85rem'>" + check + "</td> " +
                                    "<td hidden class='text-start p-1' style='font-size: 0.85rem'>" + list[i][12] + "</td> " +
                                    "</tr> ");
                            }
                        }
                    }


                    var combolist = data.inputBank;
                    for (var i = 0; i < combolist.length; i++) {
                        if (combolist[i][0] == inputBank) {
                            inputBankTxt = inputBankTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][1] + "</option>";
                        } else {
                            inputBankTxt = inputBankTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][1] + "</option>";
                        }
                    }

                    var combolist2 = data.cboAct;
                    for (var i = 0; i < combolist2.length; i++) {
                        if (combolist2[i][0] == cboAct) {
                            cboActTxt = cboActTxt + "<option value='" + combolist2[i][0] + "' selected>" + combolist2[i][0] + "</option>";
                        } else {
                            cboActTxt = cboActTxt + "<option value='" + combolist2[i][0] + "'>" + combolist2[i][0] + "</option>";
                        }
                    }
                    $("#inputBank").append(inputBankTxt);
                    $("#inputAct").append(cboActTxt);


                }
            });
        });

        {# 조회 버튼 누를시 #}
        $(document).on('click', '#btnSearch', function () {
            var sDate = document.getElementById('inputStrDate').value;
            var eDate = document.getElementById('inputEndDate').value;
            var cboAct = document.getElementById('inputAct').value;
            var cboCust = document.getElementById('inputCust').value;
            var empName = document.getElementById('inputEmpName').value;
            var payGbn = document.getElementById('inputPayGbn').value;
            var Gbn = document.getElementById('inputGbn').value;

            $('.apvArea').hide();
            var strDate = sDate.replace(/\-/g, '')
            var endDate = eDate.replace(/\-/g, '')

            let data = {"strDate": strDate, "endDate": endDate, "cboAct": cboAct, "cboCust": cboCust, "empName": empName, "payGbn": payGbn, "Gbn": Gbn}

            $.ajax({
                type: "post",
                data: data,
                url: '{% url "receivePay_search" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {
                    var list = data.mainList;
                    var list2 = data.balList;
                    var outTotal = data.outresult;
                    var inTotal = data.inresult;
                    var count = 0;
                    var total = 0;
                    var check = "";
                    var apv = "";
                    var cust = "";

                    $("#withMainTb").html("");
                    {# 잔액 계산 #}
                    count = list.length;
                    {#if(list2 != ''){#}
                    {#    for (var i = 0; i < list2.length; i++) {#}
                    {#        total = parseInt(list2[0][3])#}
                    {#        $("#withMainTb").append(#}
                    {#            "<tr id='#withMainTr' class='withMainTr_tr'>" +#}
                    {#            "<td hidden class='text-center p-1' style='font-size: 0.85rem'></td>" +#}
                    {#            "<td class='text-center p-1' style='font-size: 0.85rem'></td>" +#}
                    {#            "<td class='text-center p-1' style='font-size: 0.85rem'>잔 액</td>" +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-end p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-end p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
                    {#            "</tr> ");#}
                    {#    }#}
                    {#}#}

                    if(list2 != ''){
                        for (var i = 0; i < list.length; i++) {

                            {# 입금 #}
                            if(list[i][0] == '2'){
                                total += parseInt(list[i][2])
                            }
                            {# 출금 #}
                            if(list[i][0] == '1'){
                                total -= parseInt(list[i][3])
                            }
                            if(list[i][9] == 'Y'){
                                check = '시행';
                            }
                            if(list[i][9] == 'N'){
                                check = '미시행';
                            }
                            if(list[i][21] == 'Y' ){
                                apv = '승인';
                            }
                            if(list[i][21] == 'R'){
                                apv = '반려';
                            }
                            if(list[i][21] == 'N' && list[i][24] != ''){
                               apv = list[i][24];
                            }
                            if(list[i][21] == 'N' && list[i][24] == ''){
                               apv = '미승인';
                            }
                            if(list[i][18] == '2'){
                                cust = list[i][5]
                            }
                            if(list[i][18] == '1' || list[i][18] == '3' || list[i][18] == '4'){
                                cust = list[i][22]
                            }

                            $("#withMainTb").append(
                                "<tr id='#withMainTr' class='withMainTr_tr' main_code='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'>" +
                                "<td hidden class='text-center p-1' style='font-size: 0.85rem'>" + list[i][0] + "</td>" +
                                "<td class='text-center p-1' style='font-size: 0.8rem'><input onclick='checkOnlyOne(this)' class='' type='checkbox' id='chkWith[]' name='chkWith[]' value='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'/></td>" +
                                "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][1].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3') + "</td>" +
                                "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][17].replace(/(\d{4})(\d{2})/g, '$1-$2') + "</td>" +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][14] + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][10] + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][16] + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + cust + "</td> " +
                                "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][2]) + "</td> " +
                                "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][3]) + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][7] + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + apv + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + check + "</td> " +
                                "<td hidden class='text-start p-1' style='font-size: 0.85rem'>" + list[i][12] + "</td> " +
                                "</tr> ");
                        }
                        {#$("#inputBal").val(addComma(total))#}
                        $("#inputCnt").val(addComma(count))
                    }
                    if(list2 == ''){
                        for (var i = 0; i < list.length; i++) {

                            var check = "";
                            if(list[i][9] == 'Y' ){
                                check = '시행';
                            }
                            if(list[i][9] == 'N'){
                                check = '미시행';
                            }
                            if(list[i][21] == 'Y' ){
                                apv = '승인';
                            }
                            if(list[i][21] == 'R'){
                                apv = '반려';
                            }
                            if(list[i][21] == 'N' && list[i][24] != ''){
                               apv = list[i][24];
                            }
                            if(list[i][21] == 'N' && list[i][24] == ''){
                               apv = '미승인';
                            }
                            if(list[i][18] == '2'){
                                cust = list[i][5]
                            }
                            if(list[i][18] == '1' || list[i][18] == '3' || list[i][18] == '4'){
                                cust = list[i][22]
                            }

                            $("#withMainTb").append(
                                "<tr id='#withMainTr' class='withMainTr_tr' main_code='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'>" +
                                "<td hidden class='text-center p-1' style='font-size: 0.85rem'>" + list[i][0] + "</td>" +
                                "<td class='text-center p-1' style='font-size: 0.8rem'><input onclick='checkOnlyOne(this)' class='' type='checkbox' id='chkWith[]' name='chkWith[]' value='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'/></td>" +
                                "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][1].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3') + "</td>" +
                                "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][17].replace(/(\d{4})(\d{2})/g, '$1-$2') + "</td>" +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][14] + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][10] + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][16] + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + cust + "</td> " +
                                "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][2]) + "</td> " +
                                "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][3]) + "</td> " +
                                "<td class='text-end p-1' style='font-size: 0.85rem'>" + apv + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][7] + "</td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +
                                "<td class='text-start p-1' style='font-size: 0.85rem'>" + check + "</td> " +
                                "<td hidden class='text-start p-1' style='font-size: 0.85rem'>" + list[i][12] + "</td> " +
                                "</tr> ");
                        }

                    }

                }
            })
        });

        {# 구분 선택시 조회 #}
        {#$('#inputGbn').change(function () {#}
        {##}
        {#    var sDate = document.getElementById('inputStrDate').value;#}
        {#    var eDate = document.getElementById('inputEndDate').value;#}
        {#    var inputGbn = document.getElementById('inputGbn').value;#}
        {##}
        {#    let data = {"sDate": sDate, "eDate": eDate, "inputGbn": inputGbn}#}
        {##}
        {#    $.ajax({#}
        {#        type: "post",#}
        {#        data: data,#}
        {#        url: '{% url "receivePay_search" %}',#}
        {#        headers: {#}
        {#            'X-CSRFTOKEN': '{{ csrf_token }}'#}
        {#        },#}
        {#        dataType: 'json',#}
        {#        success: function (data) {#}
        {#            var list = data.mainList;#}
        {#            var list2 = data.balList;#}
        {#            var total = 0;#}
        {#            var check = "";#}
        {#            var apv = "";#}
        {#            var cust = "";#}
        {##}
        {#            $("#withMainTb").html("");#}
                    {# 잔액 계산 #}
        {##}
        {#            if(list2 != ''){#}
        {#                for (var i = 0; i < list2.length; i++) {#}
        {#                    total = list2[0][3]#}
        {#                    $("#withMainTb").append(#}
        {#                        "<tr id='#withMainTr' class='withMainTr_tr'>" +#}
        {#                        "<td hidden class='text-center p-1' style='font-size: 0.85rem'></td>" +#}
        {#                        "<td class='text-center p-1' style='font-size: 0.85rem'></td>" +#}
        {#                        "<td class='text-center p-1' style='font-size: 0.85rem'>잔 액</td>" +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
        {#                        "<td class='text-end p-1' style='font-size: 0.85rem'></td> " +#}
        {#                        "<td class='text-end p-1' style='font-size: 0.85rem'></td> " +#}
        {#                        "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(total) + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
        {#                        "</tr> ");#}
        {#                }#}
        {#            }#}
        {##}
        {#            if(list2 != ''){#}
        {#                for (var i = 0; i < list.length; i++) {#}
        {##}
                            {# 입금 #}
        {#                    if(list[i][0] == '2'){#}
        {#                        total += list[i][2]#}
        {#                    }#}
                            {# 출금 #}
        {#                    if(list[i][0] == '1'){#}
        {#                        total -= list[i][3]#}
        {#                    }#}
        {#                    if(list[i][9] == 'Y'){#}
        {#                        check = '시행';#}
        {#                    }#}
        {#                    if(list[i][9] == 'N'){#}
        {#                        check = '미시행';#}
        {#                    }#}
        {#                    if(list[i][20] == 'Y'){#}
        {#                        apv = '승인';#}
        {#                    }#}
        {#                    if(list[i][21] == 'N' && list[i][24] != ''){#}
        {#                        apv = list[i][24];#}
        {#                    }#}
        {#                    if(list[i][21] == 'N' && list[i][24] == ''){#}
        {#                       apv = '미승인';#}
        {#                    }#}
        {#                    if(list[i][20] == '2'){#}
        {#                        cust = list[i][5]#}
        {#                    }#}
        {#                    if(list[i][20] == '1' || list[i][20] == '3' || list[i][20] == '4'){#}
        {#                        cust = list[i][22]#}
        {#                    }#}
        {##}
        {#                    $("#withMainTb").append(#}
        {#                        "<tr id='#withMainTr' class='withMainTr_tr' main_code='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'>" +#}
        {#                        "<td hidden class='text-center p-1' style='font-size: 0.85rem'>" + list[i][0] + "</td>" +#}
        {#                        "<td class='text-center p-1' style='font-size: 0.8rem'><input class='' type='checkbox' id='chkWith[]' name='chkWith[]' value='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'/></td>" +#}
        {#                        "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][1].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3') + "</td>" +#}
        {#                        "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][17].replace(/(\d{4})(\d{2})/g, '$1-$2') + "</td>" +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][10] + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][14] + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][16] + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + cust + "</td> " +#}
        {#                        "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][2]) + "</td> " +#}
        {#                        "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][3]) + "</td> " +#}
        {#                        "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(total) + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][7] + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + apv + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + check + "</td> " +#}
        {#                        "<td hidden class='text-start p-1' style='font-size: 0.85rem'>" + list[i][12] + "</td> " +#}
        {#                        "</tr> ");#}
        {#                }#}
        {#                $("#inputBal").val(addComma(total))#}
        {#            }#}
        {#            if(list2 == ''){#}
        {#                for (var i = 0; i < list.length; i++) {#}
        {##}
        {#                    if(list[i][9] == 'Y'){#}
        {#                        check = '시행';#}
        {#                    }#}
        {#                    if(list[i][9] == 'N'){#}
        {#                        check = '미시행';#}
        {#                    }#}
        {#                    if(list[i][20] == 'Y'){#}
        {#                        apv = '승인';#}
        {#                    }#}
        {#                    if(list[i][21] == 'N' && list[i][24] != ''){#}
        {#                        apv = list[i][24];#}
        {#                    }#}
        {#                    if(list[i][21] == 'N' && list[i][24] == ''){#}
        {#                       apv = '미승인';#}
        {#                    }#}
        {#                    if(list[i][20] == '2'){#}
        {#                        cust = list[i][5]#}
        {#                    }#}
        {#                    if(list[i][20] == '1' || list[i][20] == '3' || list[i][20] == '4'){#}
        {#                        cust = list[i][22]#}
        {#                    }#}
        {##}
        {#                    $("#withMainTb").append(#}
        {#                        "<tr id='#withMainTr' class='withMainTr_tr' main_code='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'>" +#}
        {#                        "<td hidden class='text-center p-1' style='font-size: 0.85rem'>" + list[i][0] + "</td>" +#}
        {#                        "<td class='text-center p-1' style='font-size: 0.8rem'><input class='' type='checkbox' id='chkWith[]' name='chkWith[]' value='" + list[i][0] + "," + list[i][1] + "," + list[i][6] + "," + list[i][4] + "," + list[i][8] + "," + list[i][12] + "'/></td>" +#}
        {#                        "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][1].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3') + "</td>" +#}
        {#                        "<td class='text-center p-1' style='font-size: 0.85rem'>" + list[i][17].replace(/(\d{4})(\d{2})/g, '$1-$2') + "</td>" +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][10] + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][14] + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][16] + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + cust + "</td> " +#}
        {#                        "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][2]) + "</td> " +#}
        {#                        "<td class='text-end p-1' style='font-size: 0.85rem'>" + addComma(list[i][3]) + "</td> " +#}
        {#                        "<td class='text-end p-1' style='font-size: 0.85rem'>" + apv + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][7] + "</td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'></td> " +#}
        {#                        "<td class='text-start p-1' style='font-size: 0.85rem'>" + check + "</td> " +#}
        {#                        "<td hidden class='text-start p-1' style='font-size: 0.85rem'>" + list[i][12] + "</td> " +#}
        {#                        "</tr> ");#}
        {#                }#}
        {##}
        {#            }#}
        {##}
        {#        }#}
        {#    })#}
        {#});#}


        {# 조회 조건 카드명 선택시 카드번호 바인딩 #}
        $('#inputCard').change(function () {
            var inputCardNum = "";
            var inputCardNumTxt = "<option value=''>:: 선택 ::</option>";

            $("#inputCardNum").html("");

            var inputCard = document.getElementById('inputCard').value;

            let data = {"cboCardName": inputCard}

            $.ajax({
                type: "post",
                url: '{% url "cboAct" %}',
                data: data,
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {

                    var combolist = data.cboCard;
                    for (var i = 0; i < combolist.length; i++) {
                        if (combolist[i][0] == inputCardNum) {
                            inputCardNumTxt = inputCardNumTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][0] + "</option>";
                        } else {
                            inputCardNumTxt = inputCardNumTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][0] + "</option>";
                        }
                    }

                    $("#inputCardNum").append(inputCardNumTxt);

                }
            });

        });

        $('#inputCustName').change(function () {
            if($('#inputCustName').val('')){
                $('#inputCust').val('');
            }
        });

        {# 조회 조건 은행명 선택시 계좌명 바인딩 #}
        $('#inputBank').change(function () {

            var inputAct = "";
            var inputActTxt = "<option value=''>:: 선택 ::</option>";

            $("#inputAct").html("");

            var inputBank = document.getElementById('inputBank').value;

            let data = {"inputBank": inputBank}

            $.ajax({
                type: "post",
                data: data,
                url: '{% url "cboBank" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {

                    var combolist2 = data.cboAct;
                    for (var i = 0; i < combolist2.length; i++) {
                        if (combolist2[i][0] == inputAct) {
                            inputActTxt = inputActTxt + "<option value='" + combolist2[i][0] + "' selected>" + combolist2[i][0] + "</option>";
                        } else {
                            inputActTxt = inputActTxt + "<option value='" + combolist2[i][0] + "'>" + combolist2[i][0] + "</option>";
                        }
                    }

                    $("#inputAct").append(inputActTxt);
                }
            })
        });

        {# 파일 선택 버튼 클릭시 #}
        $(document).on('click', '.btnFile', function () {
            const findex = $(this).data('findex');

            $(`#file${findex}`).click();
        });
        {#$(document).on('click', '#btnFile', function () {#}
        {#    $("#file").click();#}
        {#});#}

        {# 파일 보기 버튼 클릭시 #}
        $(document).on('click', '#btnFileLook', function (){
            var ioDate = $("#txtWitRegDate").val();
            var acSeqn = $("#txtWitSeq").val();
            var acIogb = $("#cboWitGbn").val();
            var acCust = $("#cboWitCust").val();

            location.href = "{% url 'download_file' %}?ioDate=" + ioDate + "&acSeqn=" + acSeqn + "&acIogb=" + acIogb + "&acCust=" + acCust;
        });

        $(document).on('change', '.file', function () {
            const findex = $(this).data('findex');
            $(`#file_name${findex}`).empty();

            var fileList = JSON.parse($('#fileListInput').val());

            if(this.files.length > 0) {
                // 파일명을 배열에 추가
                fileList[findex-1] = this.files[0].name;

                $('#fileListInput').val(JSON.stringify(fileList));

                // 파일명 추가
                $(`#file_name${findex}`).append($('<a href="#" class="btn btn-sm btn-outline-info text-dark">').text(this.files[0].name));

                // 파일 삭제 버튼 추가
                $(`.btnFileDelWrapper${findex}`).append(`<a class="btn btn-outline-danger btn-sm btnFileDel" type="button" id="btnFileDel${findex}" data-findex="${findex}">삭제</a>`);
            }
        });


{#        $(document).on('change', '#file', function () {#}
{#            $('#file_name').empty();#}
{##}
            {# 파일을 한번에 여러개(구현됨) 또는 한개씩 여러번 쌓아서 저장  #}
{#            $.each(this.files, function(i, file) {#}
{##}
                {#$('#file_name').append($('<span>').text(file.name));#}
{#                버튼 밑에 세로로 remove a tag 넣기 : 이 파일 삭제#}
{#                $('#file_name').append($('<button class="btn btn-sm btn-outline-info text-dark">').text(file.name));#}
                {#$('#file_name').append($('<a class="dz-remove">').text('Remove'));#}
{#            });#}
{#        });#}

        {# 전결 버튼 누를시 #}
        {# 버튼색깔: class명: btn-outline-warning #}
        $(document).on('click', '#btnApv', function () {
            if($(this).hasClass('btn-warning')) {
                $("#txtApvAll").val('100');
                $(this).removeClass('btn-warning');
                $(this).addClass('btn-outline-warning');
            } else {
                $("#txtApvAll").val('');
                $(this).removeClass('btn-outline-warning');
                $(this).addClass('btn-warning');
            }


        });

        {# 테이블 로우 클릭 시 #}
        $(document).on('click', '#withMainTb .withMainTr_tr', function () {

            $('#withMainTb .withMainTr_tr').removeClass('active');
            $(this).addClass('active');

            var itemimg = "";
            var Rfilename = ""
            var imglc = ""
            var cboWitCust2 = "";
            var cboWitGbn = "";
            var cboAdminCode = "";
            var cboWitMethod = "";
            var cboWitActNum = "";
            var cboWitCard = "";
            var cboBank = "";
            var cboCardName = "";

            var folder = "";
            var permit = "";
            var cls = "";
            var cboWitCustTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitGbnTxt = "<option value=''>:: 선택 ::</option>";
            var cboAdminCodeTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitMethodTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitActNumTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitCardTxt = "<option value=''>:: 선택 ::</option>";
            var cboBankTxt = "<option value=''>:: 선택 ::</option>";
            var cboCardNameTxt = "<option value=''>:: 선택 ::</option>";

            $("#cboWitCust").html("");
            $("#cboWitGbn").html("");
            $("#cboAdminCode").html("");
            $("#cboWitMethod").html("");
            $("#cboWitActNum").html("");
            $("#cboWitCard").html("");
            $("#cboBank").html("");
            $("#cboCardName").html("");
            $("#txtWitRegDate").val("");
            $("#txtWitSeq").val("");
            $("#txtWitRecn").val("");
            $("#txtWitPrice").val("");
            $("#txtWitCashNum").val("");
            $("#txtWitRemark").val("");
            $("#txtCashDate").val("");
            $("#txtCreUser").val("");

            {#$(this).addClass('bg-gray-200');#}

            let search = $(this).attr('main_code');
            var split = search.split(',');
            var acIogb = split[0]
            var ioDate = split[1]
            var acNum = split[2]
            var acCust = split[3]
            var acMcode= split[4]
            var acSeqn= split[5]
            var cboGbn = "";
            var method = "";


            let data = {'acIogb': acIogb, 'ioDate': ioDate, 'acNum': acNum, "acCust": acCust, 'acMcode': acMcode, "cboGbn": cboGbn, "acSeqn": acSeqn}

            var check = "";
            $.ajax({
                type: "post",
                data: data,
                url: '{% url "chkWriter" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {
                    if(data.chkEmp != ''){
                        check = 'Y'
                    }
                    if(data.chkEmp == ''){
                        check = 'N'
                    }
                    if(data.chkAcGbn == '3'){
                        cboGbn = '1'
                    }
                    if(data.chkAcGbn == '4'){
                        cboGbn = '2'
                    }
                }
            });

            let data2 = {'acIogb': acIogb, 'ioDate': ioDate, 'acNum': acNum, "acCust": acCust, 'acMcode': acMcode, "cboGbn": cboGbn, "acSeqn": acSeqn}

            $.ajax({
                type: "post",
                data: data2,
                url: '{% url "payment_search" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {
                    var list = data.subList;
                    var list2 = data.empResult;
                    var check = data.chkApv;
                    var gbn = $("#gbn").text();

                    $("#withSubTb").html("");
                    for (var i = 0; i < list.length; i++) {

                        permit = list[i][23]
                        cls = list[i][29]

                        {# 시행건은 수정못하게 #}
                        if(permit == 'Y'){
                            alert('수정 불가능한 건입니다. ')

                            $("#txtWitSeq").val(list[i][0])
                            $("#txtWitRecn").val(list[i][3])
                            $("#txtWitRegDate").val(list[i][11].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                            $("#txtExDate").val(list[i][20].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                            $("#txtWitPrice").val(addComma(list[i][10]))
                            $("#txtWitCashNum").val(list[i][15])
                            $("#txtWitRemark").val(list[i][19])
                            $("#txtTitle").val(list[i][21])
                            $("#txtWhere").val(list[i][24])
                            $("#txtInfo").val(list[i][25])
                            $("#txtApplyDate").val(list[i][27].replace(/(\d{4})(\d{2})/g, '$1-$2'))
                            $("#txtCashDate").val(list[i][34].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                            $("#txtCreUser").val(list[i][33])
                            $("#cboWitCust").val(list[i][1])
                            $("#txtCustName").val(list[i][2])
                            folder = list[i][22]
                            cboWitCust2 = list[i][1];
                            cboWitGbn = list[i][6];
                            cboWitMethod = list[i][4];
                            cboAdminCode = list[i][8];
                            cboWitActNum = list[i][12];
                            cboWitCard = list[i][22];
                            cboBank = list[i][26]
                            cboCardName = list[i][31]

                            {# Y이면 체크박스 체크되야함 #}
                            if(list[i][36] == 'Y'){
                                $('#chkPre').val('Y').prop("checked",true);
                            }
                            {# N이거나 비어있으면 체크박스 체크되야함 #}
                            else{
                                $('#chkPre').val('N').prop("checked",false);
                            }

                            var combolist = data.cboCust;
                            for (var i = 0; i < combolist.length; i++) {
                                if (combolist[i][0] == cboWitCust2) {
                                    cboWitCustTxt = cboWitCustTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][1] + "</option>";
                                }
                            }

                            var combolist2 = data.cboGgn;
                            for (var i = 0; i < combolist2.length; i++) {
                                if (combolist2[i][0] == cboWitGbn) {
                                    cboWitGbnTxt = cboWitGbnTxt + "<option value='" + combolist2[i][0] + "' selected>" + combolist2[i][1] + "</option>";
                                }
                            }

                            var combolist3 = data.cboPay;
                            for (var i = 0; i < combolist3.length; i++) {
                                if (combolist3[i][0] == cboWitMethod) {
                                    cboWitMethodTxt = cboWitMethodTxt + "<option value='" + combolist3[i][0] + "' selected>" + combolist3[i][1] + "</option>";
                                }
                            }

                            var combolist4 = data.cboMCode;
                            for (var i = 0; i < combolist4.length; i++) {
                                if (combolist4[i][0] == cboAdminCode) {
                                    cboAdminCodeTxt = cboAdminCodeTxt + "<option value='" + combolist4[i][0] + "' selected>" + combolist4[i][1] + "</option>";
                                }
                            }

                            var combolist5 = data.cboAcnumber;
                            for (var i = 0; i < combolist5.length; i++) {
                                if (combolist5[i][0] == cboWitActNum) {
                                    cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "' selected>" + combolist5[i][0] + "</option>";
                                }
                            }

                            var combolist6 = data.cboCard;
                            for (var i = 0; i < combolist6.length; i++) {
                                if (combolist6[i][0] == cboWitCard) {
                                    cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist6[i][0] + "' selected>" + combolist6[i][0] + "</option>";
                                }
                            }

                            var combolist7 = data.cboBank;
                            for (var i = 0; i < combolist7.length; i++) {
                                if (combolist7[i][0] == cboBank) {
                                    cboBankTxt = cboBankTxt + "<option value='" + combolist7[i][0] + "' selected>" + combolist7[i][1] + "</option>";
                                }
                            }

                            var combolist8 = data.cardName;
                            for (var i = 0; i < combolist8.length; i++) {
                                if (combolist8[i][0] == cboCardName) {
                                    cboCardNameTxt = cboCardNameTxt + "<option value='" + combolist8[i][0] + "' selected>" + combolist8[i][1] + "</option>";
                                }
                            }

                            $("#cboWitCust").append(cboWitCustTxt);
                            $("#cboWitGbn").append(cboWitGbnTxt);
                            $("#cboWitMethod").append(cboWitMethodTxt);
                            $("#cboAdminCode").append(cboAdminCodeTxt);
                            $("#cboWitActNum").append(cboWitActNumTxt);
                            $("#cboWitCard").append(cboWitCardTxt);
                            $("#cboBank").append(cboBankTxt);
                            $("#cboCardName").append(cboCardNameTxt);


                            $("#cboWitGbn").attr("disabled",true);
                            $("#cboWitMethod").attr("disabled",true);
                            $("#cboWitCust").attr("disabled",true);
                            $("#cboAdminCode").attr("disabled",true);
                            $("#cboWitActNum").attr("disabled",true);
                            $("#cboWitCard").attr("disabled",true);
                            $("#cboBank").attr("disabled",true);
                            $("#cboCardName").attr("disabled",true);
                            $("#txtWitRegDate").attr("readonly",true);
                            $("#txtWitSeq").attr("readonly",true);
                            $("#txtWitRecn").attr("readonly",true);
                            $("#txtExDate").attr("readonly",true);
                            $("#txtWitPrice").attr("readonly",true);
                            $("#txtWitCashNum").attr("readonly",true);
                            $("#txtWitRemark").attr("readonly",true);
                            $("#txtTitle").attr("readonly",true);
                            $("#txtInfo").attr("readonly",true);
                            $("#txtApplyDate").attr("readonly",true);
                            $("#txtWhere").attr("readonly",true);
                            $("#txtCashDate").attr("readonly",true);
                            $("#txtCreUser").attr("readonly",true);
                            $("#txtCustName").attr("readonly",true);
                            document.getElementById("cboWitGbn").classList.add('bg-transparent')
                            document.getElementById("cboWitMethod").classList.add('bg-transparent')
                            document.getElementById("cboWitCust").classList.add('bg-transparent')
                            document.getElementById("cboAdminCode").classList.add('bg-transparent')
                            document.getElementById("cboWitActNum").classList.add('bg-transparent')
                            document.getElementById("cboWitCard").classList.add('bg-transparent')
                            document.getElementById("cboBank").classList.add('bg-transparent')
                            document.getElementById("cboCardName").classList.add('bg-transparent')
                            document.getElementById("txtWitRegDate").classList.add('bg-transparent')
                            document.getElementById("txtWitSeq").classList.add('bg-transparent')
                            document.getElementById("txtWitRecn").classList.add('bg-transparent')
                            document.getElementById("txtExDate").classList.add('bg-transparent')
                            document.getElementById("txtWhere").classList.add('bg-transparent')
                            document.getElementById("txtWitPrice").classList.add('bg-transparent')
                            {#document.getElementById("txtWitCashNum").classList.add('bg-transparent')#}
                            document.getElementById("txtWitRemark").classList.add('bg-transparent')
                            document.getElementById("txtTitle").classList.add('bg-transparent')
                            document.getElementById("txtInfo").classList.add('bg-transparent')
                            document.getElementById("txtApplyDate").classList.add('bg-transparent')
                            document.getElementById("txtWhere").classList.add('bg-transparent')
                            document.getElementById("txtCashDate").classList.add('bg-transparent')
                            document.getElementById("txtCreUser").classList.add('bg-transparent')
                            document.getElementById("txtCustName").classList.add('bg-transparent')

                            $('.folderArea').hide();
                            $('.apvArea').hide();
                            $('.line').hide();

                            $('.basic').show();
                            {#if(cboWitMethod == '4'){#}
                            {##}
                            {#    $('.txtUser').show();#}
                            {#    $('.cboCard').hide();#}
                            {#    $('.cboBank').hide();#}
                            {#    $('.cboAct').hide();#}
                            {#    $('.writer').hide();#}
                            {#    $('.cashDate').show();#}
                            {#    $('.cardName').hide();#}
                            {#    $('.cboCust').hide();#}
                            {#    $('.txtApply').show();#}
                            {#    $('.txtExpect').hide();#}
                            {#    $('.creUser').show();#}
                            {#    $('.checkPre').show();#}
                            {#}#}
                            if(cboWitMethod == '3' || cboWitMethod == '4'){

                                $('.txtUser').show();
                                $('.cboBank').hide();
                                $('.cardName').show();
                                $('.cboCard').show();
                                $('.cboAct').show();
                                $('.cboCust').hide();
                                $('.writer').hide();
                                $('.cashDate').hide();
                                $('.txtApply').show();
                                $('.txtExpect').show();
                                $('.creUser').show();
                                $('.checkPre').hide();
                            }
                            else if(cboWitMethod == '2'){
                                $('.txtUser').hide();
                                $('.cboCard').hide();
                                $('.cardName').hide();
                                $('.writer').hide();
                                $('.cashDate').hide();
                                $('.cboBank').hide();
                                $('.cboAct').hide();
                                $('.cboCust').show();
                                $('.txtApply').show();
                                $('.txtExpect').show();
                                $('.creUser').show();
                                $('.checkPre').hide();
                            }
                            else if(cboWitMethod == '1'){
                                $('.txtUser').show();
                                $('.cboCard').hide();
                                $('.cboBank').hide();
                                $('.cboAct').hide();
                                $('.writer').show();
                                $('.cashDate').show();
                                $('.cardName').hide();
                                $('.cboCust').hide();
                                $('.txtApply').show();
                                $('.txtExpect').hide();
                                $('.creUser').show();
                                $('.checkPre').show();
                            }
                        }
                        else{
                            {# 결재를 한사람이라도 한 건은 수정 못하게 #}
                            if(parseInt(check) > 0){
                                $("#txtWitSeq").val(list[i][0])
                                $("#txtWitRecn").val(list[i][3])
                                $("#txtWitRegDate").val(list[i][11].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                                $("#txtExDate").val(list[i][20].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                                $("#txtWitPrice").val(addComma(list[i][10]))
                                $("#txtWitCashNum").val(list[i][15])
                                $("#txtWitRemark").val(list[i][19])
                                $("#txtTitle").val(list[i][21])
                                $("#txtWhere").val(list[i][24])
                                $("#txtInfo").val(list[i][25])
                                $("#txtApplyDate").val(list[i][27].replace(/(\d{4})(\d{2})/g, '$1-$2'))
                                $("#txtCreUser").val(list[i][33])
                                $("#txtCashDate").val(list[i][34].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                                $("#cboWitCust").val(list[i][1])
                                $("#txtCustName").val(list[i][2])
                                folder = list[i][22]
                                cboWitCust2 = list[i][1];
                                cboWitGbn = list[i][6];
                                cboWitMethod = list[i][4];
                                cboAdminCode = list[i][8];
                                cboWitActNum = list[i][12];
                                cboWitCard = list[i][22];
                                cboBank = list[i][26]
                                cboCardName = list[i][31]

                                if(list[i][36] == 'Y'){
                                    $('#chkPre').prop("checked",true);
                                }
                                else{
                                    $('#chkPre').prop("checked",false);
                                }
                                if(list[i][37] == 'Y'){
                                    $('.apvArea').hide();
                                    $('.line').hide();
                                }

                                var combolist = data.cboCust;
                                for (var i = 0; i < combolist.length; i++) {
                                    if (combolist[i][0] == cboWitCust2) {
                                        cboWitCustTxt = cboWitCustTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][1] + "</option>";
                                    }
                                }

                                var combolist2 = data.cboGgn;
                                for (var i = 0; i < combolist2.length; i++) {
                                    if (combolist2[i][0] == cboWitGbn) {
                                        cboWitGbnTxt = cboWitGbnTxt + "<option value='" + combolist2[i][0] + "' selected>" + combolist2[i][1] + "</option>";
                                    }
                                }

                                var combolist3 = data.cboPay;
                                for (var i = 0; i < combolist3.length; i++) {
                                    if (combolist3[i][0] == cboWitMethod) {
                                        cboWitMethodTxt = cboWitMethodTxt + "<option value='" + combolist3[i][0] + "' selected>" + combolist3[i][1] + "</option>";
                                    }
                                }

                                var combolist4 = data.cboMCode;
                                for (var i = 0; i < combolist4.length; i++) {
                                    if (combolist4[i][0] == cboAdminCode) {
                                        cboAdminCodeTxt = cboAdminCodeTxt + "<option value='" + combolist4[i][0] + "' selected>" + combolist4[i][1] + "</option>";
                                    }
                                }

                                var combolist5 = data.cboAcnumber;
                                for (var i = 0; i < combolist5.length; i++) {
                                    if (combolist5[i][0] == cboWitActNum) {
                                        cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "' selected>" + combolist5[i][0] + "</option>";
                                    }
                                }

                                var combolist6 = data.cboCard;
                                for (var i = 0; i < combolist6.length; i++) {
                                    if (combolist6[i][0] == cboWitCard) {
                                        cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist6[i][0] + "' selected>" + combolist6[i][0] + "</option>";
                                    }
                                }

                                var combolist7 = data.cboBank;
                                for (var i = 0; i < combolist7.length; i++) {
                                    if (combolist7[i][0] == cboBank) {
                                        cboBankTxt = cboBankTxt + "<option value='" + combolist7[i][0] + "' selected>" + combolist7[i][1] + "</option>";
                                    }
                                }

                                var combolist8 = data.cardName;
                                for (var i = 0; i < combolist8.length; i++) {
                                    if (combolist8[i][0] == cboCardName) {
                                        cboCardNameTxt = cboCardNameTxt + "<option value='" + combolist8[i][0] + "' selected>" + combolist8[i][1] + "</option>";
                                    }
                                }

                                $("#cboWitCust").append(cboWitCustTxt);
                                $("#cboWitGbn").append(cboWitGbnTxt);
                                $("#cboWitMethod").append(cboWitMethodTxt);
                                $("#cboAdminCode").append(cboAdminCodeTxt);
                                $("#cboWitActNum").append(cboWitActNumTxt);
                                $("#cboWitCard").append(cboWitCardTxt);
                                $("#cboBank").append(cboBankTxt);
                                $("#cboCardName").append(cboCardNameTxt);


                                $("#cboWitGbn").attr("disabled",true);
                                $("#cboWitMethod").attr("disabled",true);
                                $("#cboWitCust").attr("disabled",true);
                                $("#cboAdminCode").attr("disabled",true);
                                $("#cboWitActNum").attr("disabled",true);
                                $("#cboWitCard").attr("disabled",true);
                                $("#cboBank").attr("disabled",true);
                                $("#cboCardName").attr("disabled",true);
                                $("#txtWitRegDate").attr("readonly",true);
                                $("#txtWitSeq").attr("readonly",true);
                                $("#txtWitRecn").attr("readonly",true);
                                $("#txtExDate").attr("readonly",true);
                                $("#txtWitPrice").attr("readonly",true);
                                $("#txtWitCashNum").attr("readonly",true);
                                $("#txtWitRemark").attr("readonly",true);
                                $("#txtTitle").attr("readonly",true);
                                $("#txtInfo").attr("readonly",true);
                                $("#txtApplyDate").attr("readonly",true);
                                $("#txtWhere").attr("readonly",true);
                                $("#txtCashDate").attr("readonly",true);
                                $("#txtCreUser").attr("readonly",true);
                                $("#txtCustName").attr("readonly",true);
                                document.getElementById("cboWitGbn").classList.add('bg-transparent')
                                document.getElementById("cboWitMethod").classList.add('bg-transparent')
                                document.getElementById("cboWitCust").classList.add('bg-transparent')
                                document.getElementById("cboAdminCode").classList.add('bg-transparent')
                                document.getElementById("cboWitActNum").classList.add('bg-transparent')
                                document.getElementById("cboWitCard").classList.add('bg-transparent')
                                document.getElementById("cboBank").classList.add('bg-transparent')
                                document.getElementById("cboCardName").classList.add('bg-transparent')
                                document.getElementById("txtWitRegDate").classList.add('bg-transparent')
                                document.getElementById("txtWitSeq").classList.add('bg-transparent')
                                document.getElementById("txtWitRecn").classList.add('bg-transparent')
                                document.getElementById("txtExDate").classList.add('bg-transparent')
                                document.getElementById("txtWhere").classList.add('bg-transparent')
                                document.getElementById("txtWitPrice").classList.add('bg-transparent')
                                {#document.getElementById("txtWitCashNum").classList.add('bg-transparent')#}
                                document.getElementById("txtWitRemark").classList.add('bg-transparent')
                                document.getElementById("txtTitle").classList.add('bg-transparent')
                                document.getElementById("txtInfo").classList.add('bg-transparent')
                                document.getElementById("txtApplyDate").classList.add('bg-transparent')
                                document.getElementById("txtWhere").classList.add('bg-transparent')
                                document.getElementById("txtCashDate").classList.add('bg-transparent')
                                document.getElementById("txtCreUser").classList.add('bg-transparent')
                                document.getElementById("txtCustName").classList.add('bg-transparent')

                                $('.folderArea').hide();
                                $('.apvArea').show();
                                $('.line').hide();

                            }
                            {# 2등급은 본인꺼 재외한 다른건은 수정할 수 없다. #}
                            else if(cls != gbn && gbn == '2'){
                                $("#txtWitSeq").val(list[i][0])
                                $("#txtWitRecn").val(list[i][3])
                                $("#txtWitRegDate").val(list[i][11].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                                $("#txtExDate").val(list[i][20].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                                $("#txtWitPrice").val(addComma(list[i][10]))
                                $("#txtWitCashNum").val(list[i][15])
                                $("#txtWitRemark").val(list[i][19])
                                $("#txtTitle").val(list[i][21])
                                $("#txtWhere").val(list[i][24])
                                $("#txtInfo").val(list[i][25])
                                $("#txtApplyDate").val(list[i][27].replace(/(\d{4})(\d{2})/g, '$1-$2'))
                                $("#txtCreUser").val(list[i][33])
                                $("#txtCashDate").val(list[i][34].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                                $("#cboWitCust").val(list[i][1])
                                $("#txtCustName").val(list[i][2])
                                folder = list[i][22]
                                cboWitCust2 = list[i][1];
                                cboWitGbn = list[i][6];
                                cboWitMethod = list[i][4];
                                cboAdminCode = list[i][8];
                                cboWitActNum = list[i][12];
                                cboWitCard = list[i][22];
                                cboBank = list[i][26]
                                cboCardName = list[i][31]


                                {# Y이면 체크박스 체크되야함 #}
                                if(list[i][36] == 'Y'){
                                    $('#chkPre').val('Y').prop("checked",true);
                                }
                                {# N이거나 비어있으면 체크박스 체크되야함 #}
                                else{
                                    $('#chkPre').val('N').prop("checked",false);
                                }
                                if(list[i][37] == 'Y'){
                                    $('.apvArea').hide();
                                    $('.line').hide();
                                }

                                var combolist = data.cboCust;
                                for (var i = 0; i < combolist.length; i++) {
                                    if (combolist[i][0] == cboWitCust2) {
                                        cboWitCustTxt = cboWitCustTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][1] + "</option>";
                                    }
                                }

                                var combolist2 = data.cboGgn;
                                for (var i = 0; i < combolist2.length; i++) {
                                    if (combolist2[i][0] == cboWitGbn) {
                                        cboWitGbnTxt = cboWitGbnTxt + "<option value='" + combolist2[i][0] + "' selected>" + combolist2[i][1] + "</option>";
                                    }
                                }

                                var combolist3 = data.cboPay;
                                for (var i = 0; i < combolist3.length; i++) {
                                    if (combolist3[i][0] == cboWitMethod) {
                                        cboWitMethodTxt = cboWitMethodTxt + "<option value='" + combolist3[i][0] + "' selected>" + combolist3[i][1] + "</option>";
                                    }
                                }

                                var combolist4 = data.cboMCode;
                                for (var i = 0; i < combolist4.length; i++) {
                                    if (combolist4[i][0] == cboAdminCode) {
                                        cboAdminCodeTxt = cboAdminCodeTxt + "<option value='" + combolist4[i][0] + "' selected>" + combolist4[i][1] + "</option>";
                                    }
                                }

                                var combolist5 = data.cboAcnumber;
                                for (var i = 0; i < combolist5.length; i++) {
                                    if (combolist5[i][0] == cboWitActNum) {
                                        cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "' selected>" + combolist5[i][0] + "</option>";
                                    }
                                }

                                var combolist6 = data.cboCard;
                                for (var i = 0; i < combolist6.length; i++) {
                                    if (combolist6[i][0] == cboWitCard) {
                                        cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist6[i][0] + "' selected>" + combolist6[i][0] + "</option>";
                                    }
                                }

                                var combolist7 = data.cboBank;
                                for (var i = 0; i < combolist7.length; i++) {
                                    if (combolist7[i][0] == cboBank) {
                                        cboBankTxt = cboBankTxt + "<option value='" + combolist7[i][0] + "' selected>" + combolist7[i][1] + "</option>";
                                    }
                                }

                                var combolist8 = data.cardName;
                                for (var i = 0; i < combolist8.length; i++) {
                                    if (combolist8[i][0] == cboCardName) {
                                        cboCardNameTxt = cboCardNameTxt + "<option value='" + combolist8[i][0] + "' selected>" + combolist8[i][1] + "</option>";
                                    }
                                }

                                $("#cboWitCust").append(cboWitCustTxt);
                                $("#cboWitGbn").append(cboWitGbnTxt);
                                $("#cboWitMethod").append(cboWitMethodTxt);
                                $("#cboAdminCode").append(cboAdminCodeTxt);
                                $("#cboWitActNum").append(cboWitActNumTxt);
                                $("#cboWitCard").append(cboWitCardTxt);
                                $("#cboBank").append(cboBankTxt);
                                $("#cboCardName").append(cboCardNameTxt);


                                $("#cboWitGbn").attr("disabled",true);
                                $("#cboWitMethod").attr("disabled",true);
                                $("#cboWitCust").attr("disabled",true);
                                $("#cboAdminCode").attr("disabled",true);
                                $("#cboWitActNum").attr("disabled",true);
                                $("#cboWitCard").attr("disabled",true);
                                $("#cboBank").attr("disabled",true);
                                $("#cboCardName").attr("disabled",true);
                                $("#txtWitRegDate").attr("readonly",true);
                                $("#txtWitSeq").attr("readonly",true);
                                $("#txtWitRecn").attr("readonly",true);
                                $("#txtExDate").attr("readonly",true);
                                $("#txtWitPrice").attr("readonly",true);
                                $("#txtWitCashNum").attr("readonly",true);
                                $("#txtWitRemark").attr("readonly",true);
                                $("#txtTitle").attr("readonly",true);
                                $("#txtInfo").attr("readonly",true);
                                $("#txtApplyDate").attr("readonly",true);
                                $("#txtWhere").attr("readonly",true);
                                $("#txtCashDate").attr("readonly",true);
                                $("#txtCreUser").attr("readonly",true);
                                $("#txtCustName").attr("readonly",true);
                                document.getElementById("cboWitGbn").classList.add('bg-transparent')
                                document.getElementById("cboWitMethod").classList.add('bg-transparent')
                                document.getElementById("cboWitCust").classList.add('bg-transparent')
                                document.getElementById("cboAdminCode").classList.add('bg-transparent')
                                document.getElementById("cboWitActNum").classList.add('bg-transparent')
                                document.getElementById("cboWitCard").classList.add('bg-transparent')
                                document.getElementById("cboBank").classList.add('bg-transparent')
                                document.getElementById("cboCardName").classList.add('bg-transparent')
                                document.getElementById("txtWitRegDate").classList.add('bg-transparent')
                                document.getElementById("txtWitSeq").classList.add('bg-transparent')
                                document.getElementById("txtWitRecn").classList.add('bg-transparent')
                                document.getElementById("txtExDate").classList.add('bg-transparent')
                                document.getElementById("txtWhere").classList.add('bg-transparent')
                                document.getElementById("txtWitPrice").classList.add('bg-transparent')
                                {#document.getElementById("txtWitCashNum").classList.add('bg-transparent')#}
                                document.getElementById("txtWitRemark").classList.add('bg-transparent')
                                document.getElementById("txtTitle").classList.add('bg-transparent')
                                document.getElementById("txtInfo").classList.add('bg-transparent')
                                document.getElementById("txtApplyDate").classList.add('bg-transparent')
                                document.getElementById("txtWhere").classList.add('bg-transparent')
                                document.getElementById("txtCashDate").classList.add('bg-transparent')
                                document.getElementById("txtCreUser").classList.add('bg-transparent')
                                document.getElementById("txtCustName").classList.add('bg-transparent')

                                $('.folderArea').hide();
                                $('.apvArea').show();

                            }
                            else{
                                $("#cboWitGbn").attr("disabled",false);
                                $("#cboWitMethod").attr("disabled",false);
                                $("#cboWitCust").attr("disabled",false);
                                $("#cboAdminCode").attr("disabled",false);
                                $("#cboWitActNum").attr("disabled",false);
                                $("#cboWitCard").attr("disabled",false);
                                $("#cboBank").attr("disabled",false);
                                $("#cboCardName").attr("disabled",false);
                                $("#txtWitRegDate").attr("readonly",false);
                                $("#txtWitSeq").attr("readonly",false);
                                $("#txtWitRecn").attr("readonly",false);
                                $("#txtExDate").attr("readonly",false);
                                $("#txtWitPrice").attr("readonly",false);
                                $("#txtWitCashNum").attr("readonly",false);
                                $("#txtWitRemark").attr("readonly",false);
                                $("#txtTitle").attr("readonly",false);
                                $("#txtInfo").attr("readonly",false);
                                $("#txtApplyDate").attr("readonly",false);
                                $("#txtWhere").attr("readonly",false);
                                $("#txtCashDate").attr("readonly",false);
                                $("#txtCreUser").attr("readonly",false);
                                $("#txtCustName").attr("readonly",false);
                                $('.folderArea').show();
                                $('.apvArea').show();

                                $("#txtWitSeq").val(list[i][0])
                                $("#txtWitRecn").val(list[i][3])
                                $("#txtWitRegDate").val(list[i][11].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                                $("#txtExDate").val(list[i][20].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                                $("#txtWitPrice").val(addComma(list[i][10]))
                                $("#txtWitCashNum").val(list[i][15])
                                $("#txtWitRemark").val(list[i][19])
                                $("#txtTitle").val(list[i][21])
                                $("#txtWhere").val(list[i][24])
                                $("#txtInfo").val(list[i][25])
                                $("#txtApplyDate").val(list[i][27].replace(/(\d{4})(\d{2})/g, '$1-$2'))
                                $("#txtCreUser").val(list[i][33])
                                $("#txtCashDate").val(list[i][34].replace(/(\d{4})(\d{2})(\d{2})/g, '$1-$2-$3'))
                                $("#cboWitCust").val(list[i][1])
                                $("#txtCustName").val(list[i][2])
                                folder = list[i][22]
                                cboWitCust2 = list[i][1];
                                cboWitGbn = list[i][6];
                                cboWitMethod = list[i][4];
                                cboAdminCode = list[i][8];
                                cboWitActNum = list[i][12];
                                cboWitCard = list[i][22];
                                cboBank = list[i][26]
                                cboCardName = list[i][31]
                                if(list[i][35] != ''){ $("#txtApvAll").val(list[i][35]) }
                                if(list[i][35] == ''){ $("#txtApvAll").val(check) }

                                {# Y이면 체크박스 체크되야함 #}
                                if(list[i][36] == 'Y'){
                                    $('#chkPre').val('Y').prop("checked",true);
                                }
                                {# N이거나 비어있으면 체크박스 체크되야함 #}
                                else{
                                    $('#chkPre').val('N').prop("checked",false);
                                }
                                if(list[i][37] == 'Y'){
                                    $('.apvArea').hide();
                                    $('.line').hide();
                                }

                                var combolist = data.cboCust;
                                for (var i = 0; i < combolist.length; i++) {
                                    if (combolist[i][0] == cboWitCust2) {
                                        cboWitCustTxt = cboWitCustTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][1] + "</option>";
                                    } else {
                                        cboWitCustTxt = cboWitCustTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][1] + "</option>";
                                    }
                                }

                                var combolist2 = data.cboGgn;
                                for (var i = 0; i < combolist2.length; i++) {
                                    if (combolist2[i][0] == cboWitGbn) {
                                        cboWitGbnTxt = cboWitGbnTxt + "<option value='" + combolist2[i][0] + "' selected>" + combolist2[i][1] + "</option>";
                                    } else {
                                        cboWitGbnTxt = cboWitGbnTxt + "<option value='" + combolist2[i][0] + "'>" + combolist2[i][1] + "</option>";
                                    }
                                }

                                var combolist3 = data.cboPay;
                                for (var i = 0; i < combolist3.length; i++) {
                                    if (combolist3[i][0] == cboWitMethod) {
                                        cboWitMethodTxt = cboWitMethodTxt + "<option value='" + combolist3[i][0] + "' selected>" + combolist3[i][1] + "</option>";
                                    } else {
                                        cboWitMethodTxt = cboWitMethodTxt + "<option value='" + combolist3[i][0] + "'>" + combolist3[i][1] + "</option>";
                                    }
                                }

                                var combolist4 = data.cboMCode;
                                for (var i = 0; i < combolist4.length; i++) {
                                    if (combolist4[i][0] == cboAdminCode) {
                                        cboAdminCodeTxt = cboAdminCodeTxt + "<option value='" + combolist4[i][0] + "' selected>" + combolist4[i][1] + "</option>";
                                    } else {
                                        cboAdminCodeTxt = cboAdminCodeTxt + "<option value='" + combolist4[i][0] + "'>" + combolist4[i][1] + "</option>";
                                    }
                                }

                                var combolist5 = data.cboAcnumber;
                                for (var i = 0; i < combolist5.length; i++) {
                                    if (combolist5[i][0] == cboWitActNum) {
                                        cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "' selected>" + combolist5[i][0] + "</option>";
                                    } else {
                                        cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "'>" + combolist5[i][0] + "</option>";
                                    }
                                }

                                var combolist6 = data.cboCard;
                                for (var i = 0; i < combolist6.length; i++) {
                                    if (combolist6[i][0] == cboWitCard) {
                                        cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist6[i][0] + "' selected>" + combolist6[i][0] + "</option>";
                                    } else {
                                        cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist6[i][0] + "'>" + combolist6[i][0] + "</option>";
                                    }
                                }

                                var combolist7 = data.cboBank;
                                for (var i = 0; i < combolist7.length; i++) {
                                    if (combolist7[i][0] == cboBank) {
                                        cboBankTxt = cboBankTxt + "<option value='" + combolist7[i][0] + "' selected>" + combolist7[i][1] + "</option>";
                                    } else {
                                        cboBankTxt = cboBankTxt + "<option value='" + combolist7[i][0] + "'>" + combolist7[i][1] + "</option>";
                                    }
                                }

                                var combolist8 = data.cardName;
                                for (var i = 0; i < combolist8.length; i++) {
                                    if (combolist8[i][0] == cboCardName) {
                                        cboCardNameTxt = cboCardNameTxt + "<option value='" + combolist8[i][0] + "' selected>" + combolist8[i][1] + "</option>";
                                    } else {
                                        cboCardNameTxt = cboCardNameTxt + "<option value='" + combolist8[i][0] + "'>" + combolist8[i][1] + "</option>";
                                    }
                                }

                                $("#cboWitCust").append(cboWitCustTxt);
                                $("#cboWitGbn").append(cboWitGbnTxt);
                                $("#cboWitMethod").append(cboWitMethodTxt);
                                $("#cboAdminCode").append(cboAdminCodeTxt);
                                $("#cboWitActNum").append(cboWitActNumTxt);
                                $("#cboWitCard").append(cboWitCardTxt);
                                $("#cboBank").append(cboBankTxt);
                                $("#cboCardName").append(cboCardNameTxt);

                            }

                            $('.basic').show();
                            {#if(cboWitMethod == '4'){#}
                            {#    $('.txtUser').show();#}
                            {#    $('.cboCard').hide();#}
                            {#    $('.cboBank').hide();#}
                            {#    $('.cboAct').hide();#}
                            {#    $('.writer').hide();#}
                            {#    $('.cashDate').show();#}
                            {#    $('.cardName').hide();#}
                            {#    $('.cboCust').hide();#}
                            {#    $('.txtApply').show();#}
                            {#    $('.txtExpect').hide();#}
                            {#    $('.creUser').show();#}
                            {#    $('.checkPre').show();#}
                            {#}#}
                            if(cboWitMethod == '3' || cboWitMethod == '4'){
                                $('.txtUser').show();
                                $('.cboBank').hide();
                                $('.cardName').show();
                                $('.cboCard').show();
                                $('.cboAct').show();
                                $('.cboCust').hide();
                                $('.writer').hide();
                                $('.cashDate').hide();
                                $('.txtApply').show();
                                $('.txtExpect').show();
                                $('.creUser').show();
                                $('.checkPre').hide();
                            }
                            else if(cboWitMethod == '2'){
                                $('.txtUser').hide();
                                $('.cboCard').hide();
                                $('.cardName').hide();
                                $('.writer').hide();
                                $('.cashDate').hide();
                                $('.cboBank').hide();
                                $('.cboAct').hide();
                                $('.cboCust').show();
                                $('.txtApply').show();
                                $('.txtExpect').show();
                                $('.creUser').show();
                                $('.checkPre').hide();
                            }
                            else if(cboWitMethod == '1'){
                                $('.txtUser').show();
                                $('.cboCard').hide();
                                $('.cboBank').hide();
                                $('.cboAct').hide();
                                $('.writer').show();
                                $('.cashDate').show();
                                $('.cardName').hide();
                                $('.cboCust').hide();
                                $('.txtApply').show();
                                $('.txtExpect').hide();
                                $('.creUser').show();
                                $('.checkPre').show();
                            }
                        }
                    }


                    $("#subTb").html("");
                    $("#subTb").append("<tr id='#subTr' class='subTr_tr'>" + "</tr> ");
                    for (var i = 0; i < list2.length; i++) {
                        if(list2[i][7] == 'Y'){
                            $("#subTb").append(
                                "<td class='text-center border border-warning font-weight-bolder text-dark p-1' style='font-size: 0.85rem; background-color: #fbdcd8'>" + list2[i][0] + "." + list2[i][2] + "</td> ");
                        }
                        if(list2[i][7] == 'N'){
                            $("#subTb").append(
                                "<td class='text-center border border-warning bg-white font-weight-bolder text-dark p-1' style='font-size: 0.85rem'>" + list2[i][0] + "." + list2[i][2] + "</td> ");
                        }
                    }


                    $('#signTd').empty();
                    if(permit == 'Y'){}
                    else{
                        var permitList = data.permit;
                        for (var i = 0; i < permitList.length; i++) {
                            var _td = `<td class="text-start p-1 border border-white subEmpNme" id="subEmpNme_${i}" data-code="${permitList[i][1]}" style="font-size: 0.8rem">${permitList[i][2]}</td>`;
                            $('#signTd').append(_td);
                        }
                    }






                    // 증빙서류 파일 리스트 세팅
                    if(list.length > 0) {
                        var fileList = [list[0][38], list[0][39], list[0][40], list[0][41], list[0][42]];
                        $('#fileListInput').val(JSON.stringify(fileList));

                        // 뷰어허용 확장자
                        var viewer_allow_ext = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'pdf', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx'];

                        $('#fileList').empty();

                        for (var i = 0; i < fileList.length; i++) {
                            if (fileList[i] != '') {

                                // 파일명
                                var fileName = fileList[i].split('/')[fileList[i].split('/').length - 1];

                                // 파일 확장자
                                var file_ext = fileName.split('.').pop().toLowerCase();

                                // 뷰어 지원하는 확장자인지 체크
                                var is_viewer_allow_ext = viewer_allow_ext.indexOf(file_ext) != -1 ? true : false;

                                var ele =   `<table>
                                                <tbody>
                                                    <tr class="border border-light border-top-0 border-bottom border-end-0 border-start-0">
                                                        <td class="m-0 p-0 pt-2"><input name="file${i+1}" id="file${i+1}" type="file" class="file" style="display: none;" data-findex="${i+1}" /></td>
                                                        <td class="m-0 p-0 pt-2">
                                                            <a class="btn btn-outline-dark mb-2 btn-sm btnFile" type="button" id="btnFile${i+1}" data-findex="${i+1}">파일 선택</a>
                                                            <span id="file_name${i+1}" class="file_name">
                                                                <a href="${fileList[i]}" class="btn btn-sm btn-white mb-2 text-dark" target="_blank">${fileName}</a>
                                                            </span>
                                                        </td>
                                                        <td class="m-0 p-0 pt-2">${is_viewer_allow_ext ? `<a class="btn btn-outline-primary mb-2 btn-sm btnFileLook" type="button" id="btnFileLook${i+1}" data-uri="${fileList[i]}">파일 보기</a>` : ''}</td>
                                                        <td class="m-0 p-0 pt-2">
                                                            <span class="btnFileDelWrapper${i+1}">
                                                                <a class="btn btn-outline-danger btn-sm mb-2 btnFileDel" type="button" id="btnFileDel${i+1}" data-findex="${i+1}">선택 취소</a>
                                                            </span>
                                                            <input type="hidden" name="file_del_yn${i+1}" id="file_del_yn${i+1}" class="file_del_yn" value="N" />
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>`;

                                {#var ele =   `<div class="form-group text-start file-wrapper m-0">#}
                                {#                <input name="file${i+1}" id="file${i+1}" type="file" class="file" style="display: none;" data-findex="${i+1}" />#}
                                {#                <a class="btn btn-outline-dark btn-sm btnFile" type="button" id="btnFile${i+1}" data-findex="${i+1}">파일 선택</a>#}
                                {#                <span id="file_name${i+1}" class="file_name">#}
                                {#                    <a href="${fileList[i]}" class="btn btn-sm btn-outline-info text-dark" target="_blank">${fileName}</a>#}
                                {#                </span>#}
                                {#                ${is_viewer_allow_ext ? `<a class="btn btn-outline-primary btn-sm btnFileLook" type="button" id="btnFileLook${i+1}" data-uri="${fileList[i]}">파일 보기</a>` : ''}#}
                                {#                <span class="btnFileDelWrapper${i+1}">#}
                                {#                    <a class="btn btn-outline-danger btn-sm btnFileDel" type="button" id="btnFileDel${i+1}" data-findex="${i+1}">선택 취소</a>#}
                                {#                </span>#}
                                {#                <input type="hidden" name="file_del_yn${i+1}" id="file_del_yn${i+1}" class="file_del_yn" value="N" />#}
                                {#            </div>`;#}
                                $('#fileList').append(ele);
                            }
                        }
                    }
                }
            })

        });

        {# 결제방법 선택시 계좌명 바인딩 #}
        $('#cboWitMethod').change(function () {

            {#$("#cboCard").html("");#}
            {#$("#cboAct").html("");#}
            {#$("#cboAct").html("");#}

            var method = document.getElementById('cboWitMethod').value
            $('.basic').show();

            {# 체크카드 #}
            {#if(method == '4'){#}
            {##}
            {#    $('.cboCust').hide();#}
            {#    $('.cboCard').hide();#}
            {#    $('.cboBank').hide();#}
            {#    $('.cboAct').hide();#}
            {#    $('.writer').hide();#}
            {#    $('.cashDate').show();#}
            {#    $('.txtUser').show();#}
            {#    $('.cardName').hide();#}
            {#    $('.txtApply').show();#}
            {#    $('.txtExpect').hide();#}
            {#    $('.checkPre').show();#}
            {#    $('.line').show();#}
            {#    $("#txtExDate").val("");#}
            {#    $("#cboWitActNum").val("");#}
            {#    document.getElementById('txtRegDate').innerHTML = "사용일자";#}
            {##}
            {#}#}
            {# 신용카드 #}
            if(method == '3' || method == '4'){

                $('.cboCust').hide();
                $('.cboBank').hide();
                $('.cardName').show();
                $('.cboCard').show();
                $('.cboAct').show();
                $('.writer').hide();
                $('.cashDate').hide();
                $('.txtUser').show();
                $('.txtApply').show();
                $('.txtExpect').show();
                $('.checkPre').hide();
                $('.line').show();
                $("#txtExDate").val("");
                $("#cboWitActNum").val("");
                document.getElementById('txtRegDate').innerHTML = "사용일자";


                var cboCardName = "";
                var cboWitCard = "";
                var cboCardNameTxt = "<option value=''>:: 선택 ::</option>";
                var cboWitCardTxt = "<option value=''>:: 선택 ::</option>";

                $("#cboCardName").html("");
                $("#cboWitCard").html("");

                var cardType = '1';
                var CardName = '';
                let data = {"cardType": cardType, "cardName": CardName}

                $.ajax({
                    type: "post",
                    url: '{% url "cboCardType" %}',
                    data: data,
                    headers: {
                        'X-CSRFTOKEN': '{{ csrf_token }}'
                    },
                    dataType: 'json',
                    success: function (data) {

                        var combolist = data.cboCardName;
                        for (var i = 0; i < combolist.length; i++) {
                            if (combolist[i][0] == cboCardName) {
                                cboCardNameTxt = cboCardNameTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][1] + "</option>";
                            } else {
                                cboCardNameTxt = cboCardNameTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][1] + "</option>";
                            }
                        }


                        var combolist2 = data.cboCardGbn;
                        for (var j = 0; j < combolist2.length; j++) {
                            if (combolist2[j][0] == cboWitCard) {
                                cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist2[j][0] + "' selected>" + combolist2[j][0] + "</option>";
                            } else {
                                cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist2[j][0] + "'>" + combolist2[j][0] + "</option>";
                            }
                        }

                        $("#cboCardName").append(cboCardNameTxt);
                        $("#cboWitCard").append(cboWitCardTxt);
                    }
                });


            }
            {#세금계산서#}
            else if(method == '2'){
                $('.txtUser').hide();
                $('.cboCard').hide();
                $('.cardName').hide();
                $('.writer').hide();
                $('.cashDate').hide();
                $('.cboBank').hide();
                $('.cboAct').hide();
                $('.cboCust').show();
                $('.txtApply').show();
                $('.txtExpect').show();
                $('.checkPre').hide();
                $('.line').show();
                $("#txtExDate").val("");
                $("#cboWitActNum").val("");
                document.getElementById('txtRegDate').innerHTML = "발행일자";

            }
            {#현금#}
            else if(method == '1'){
                $('.cboCust').hide();
                $('.cboCard').hide();
                $('.cboBank').hide();
                $('.cboAct').hide();
                $('.writer').show();
                $('.cashDate').show();
                $('.txtUser').show();
                $('.cardName').hide();
                $('.txtApply').show();
                $('.txtExpect').hide();
                $('.checkPre').show();
                $('.line').show();
                $("#txtExDate").val("");
                $("#cboWitActNum").val("");
                document.getElementById('txtRegDate').innerHTML = "사용일자";
            }
            else{
                $('.cboCard').show();
                $('.cboBank').show();
                $('.cboAct').show();
                $('.writer').show();
                $('.cashDate').show();
                $('.cardName').show();
                $("#txtExDate").val("");
                $("#cboWitActNum").val("");
            }

        });



        $(document).on('click', '.btnFileLook', function() {
            // 파일 경로
            var file_uri = $(this).data('uri');

            // 파일 확장자
            var file_ext = file_uri.split('.').pop().toLowerCase();

            // 뷰어허용 확장자
            var viewer_allow_ext = ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'pdf', 'doc', 'docx', 'xls', 'xlsx'];

            // MS뷰어에서 지원하는 확장자
            var ms_viewer_allow_ext = ['doc', 'docx', 'xls', 'xlsx'];

            if(file_uri != ''){

                if(viewer_allow_ext.indexOf(file_ext) == -1){
                    alert('지원하지 않는 파일 형식입니다.');
                    return;
                }

                if(ms_viewer_allow_ext.indexOf(file_ext) != -1){
                    // MS뷰어에서 지원하는 확장자면 뷰어로 열기
                    file_uri = encodeURIComponent(file_uri);
                    window.open("{% url 'file_viewer' %}" + '?file_uri=' + file_uri, "_blank");
                } else {
                    window.open(file_uri, "_blank");
                }
            } else {
                alert('파일이 존재하지 않습니다.');
                return;
            }
        });


        $(document).on('click', '#addFileInputBtn', function() {
            var fileList = JSON.parse($('#fileListInput').val());

            var fileInputCnt = $('#fileList').find('.file').length;

            if(fileInputCnt >= 5){
                alert('파일은 최대 5개까지 등록 가능합니다.');
                return;
            }

            const findEmptyIndex = fileList.findIndex((item, index) => (item === ''));

            if($(`#file${findEmptyIndex+1}`).length > 0){
                alert('비어있는 파일을 먼저 선택해주세요.');
                return;
            }

            var fileInput = `<div class="form-group text-start file-wrapper">
                                <input name="file${findEmptyIndex+1}" id="file${findEmptyIndex+1}" type="file" class="file" style="display: none;" data-findex="${findEmptyIndex+1}" />
                                <a class="btn btn-outline-dark btn-sm btnFile" type="button" id="btnFile${findEmptyIndex+1}" data-findex="${findEmptyIndex+1}">파일 선택</a>
                                <span id="file_name${findEmptyIndex+1}" class="file_name"></span>
                                <span class="btnFileDelWrapper${findEmptyIndex+1}"></span>
                            </div>`;

            $('#fileList').append(fileInput);
        });

        $(document).on('click', '.btnFileDel', function() {
            var findex = $(this).data('findex');
            var fileList = JSON.parse($('#fileListInput').val());
            var fileInput = $(`#file${findex}`);

            // 업로드된 파일이 없을 경우 리턴
            if(fileList[findex-1] == ''){
                return;
            }

            var delYn = confirm('파일을 삭제하시겠습니까?');
            if(delYn){
                fileList[findex-1] = '';
                fileInput.val('');
                $(`#file_name${findex}`).empty();
                $(`#file_del_yn${findex}`).val('Y');
                $('#fileListInput').val(JSON.stringify(fileList));
                $(`#btnFileLook${findex}`).remove();
                $(`#btnFileDel${findex}`).remove();
            }
        });






        {# 카드명 선택시 계좌명 바인딩 #}
        $('#cboCardName').change(function () {

            var cboWitCard = "";
            var cboWitCardTxt = "<option value=''>:: 선택 ::</option>";

            $("#cboWitCard").html("");

            var cboCardName = document.getElementById('cboCardName').value
            var method = document.getElementById('cboWitMethod').value
            var cboCardType = "";
            if(method == '3'){ cboCardType = '1' }
            if(method == '4'){ cboCardType = '2' }

            var data = {"cboCardName": cboCardName, "cboCardType": cboCardType}

            $.ajax({
                type: "post",
                url: '{% url "cboAct" %}',
                data: data,
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {

                    var combolist = data.cboCard;
                    for (var i = 0; i < combolist.length; i++) {
                        if (combolist[i][0] == cboWitCard) {
                            cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][0] + "</option>";
                        } else {
                            cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][0] + "</option>";
                        }
                    }

                    $("#cboWitCard").append(cboWitCardTxt);
                    $("#cboWitActNum").html("");
                    $("#txtExDate").val("");
                }
            });

        });


        {# 은행명 선택시 계좌명 바인딩 #}
        $('#cboBank').change(function () {

            var cboWitActNum = "";
            var cboWitActNumTxt = "<option value=''>:: 선택 ::</option>";

            $("#cboWitActNum").html("");

            var cboBank = document.getElementById('cboBank').value

            var data = {"cboBank": cboBank}

            $.ajax({
                type: "post",
                url: '{% url "cboAct" %}',
                data: data,
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {

                    var combolist5 = data.cboAct;
                    for (var i = 0; i < combolist5.length; i++) {
                        if (combolist5[i][0] == cboWitActNum) {
                            cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "' selected>" + combolist5[i][0] + "</option>";
                        } else {
                            cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "'>" + combolist5[i][0] + "</option>";
                        }
                    }

                    $("#cboWitActNum").append(cboWitActNumTxt);
                }
            });
        });

        {# 카드번호 선택시 계좌명 바인딩 #}
        $('#cboWitCard').change(function () {

            var cboWitActNum = "";
            var cboWitActNumTxt = "";

            $("#cboWitActNum").html("");

            var card = document.getElementById('cboWitCard').value

            var data = {"card": card}

            $.ajax({
                type: "post",
                url: '{% url "cboAct" %}',
                data: data,
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {

                    var combolist = data.cboAct;
                    for (var i = 0; i < combolist.length; i++) {
                        if (combolist[i][0] == cboWitActNum) {
                            cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][0] + "</option>";
                        } else {
                            cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][0] + "</option>";
                        }
                    }

                    $("#cboWitActNum").append(cboWitActNumTxt);
                }
            });

            var method = document.getElementById('cboWitMethod').value
            var custCode = "";

            let data2 = {"method": method, "cardNum": card, "custCode": custCode}

            var date = 0;
            var gbn = "";
            if(method == '3' || method == '4'){

                $.ajax({
                    type: "post",
                    data: data2,
                    url: '{% url "chkDate" %}',
                    headers: {
                        'X-CSRFTOKEN': '{{ csrf_token }}'
                    },
                    dataType: 'json',
                    success: function (data) {

                        if(data.chkDate != ''){
                            date = data.chkDate;

                            if(date < 10){
                                date = '0' + date
                            }
                            if(date == 'last'){
                                var now = new Date;
                                date = now.getDate()
                            }

                            var newDate = new Date;
                            var year = newDate.getFullYear()
                            var month = newDate.getMonth() + 1
                            if(month > 12){
                                year = year + 1
                                month = '0' + (month - 12)
                            }
                            if(month < 10){
                                month = '0' + (month)
                            }
                            var exDate = year + "-" + month + "-" + date

                            document.getElementById("txtExDate").value = exDate;
                        }
                        else{
                            $("#txtExDate").val("");
                        }
                    }
                });
            }

        });

        {# 거래처 선택시 계좌명 바인딩 #}
       {# $('#cboWitCust').change(function () {#}
       {##}
       {#     var method = document.getElementById('cboWitMethod').value;#}
       {#     var cardNum = "";#}
       {#     var custCode = document.getElementById('cboWitCust').value;#}
       {##}
       {#     if(method == '2'){#}
       {##}
       {#         let data2 = {"method": method, "cardNum": cardNum, "custCode": custCode}#}
       {##}
       {#         var date = 0;#}
       {#         var gbn = "";#}
       {#         if(custCode == ''){#}
       {#             alert('거래처를 선택해주세요.')#}
       {#             return false;#}
       {#         }#}
       {#         if(custCode != ''){#}
       {#             $.ajax({#}
       {#                 type: "post",#}
       {#                 data: data2,#}
       {#                 url: '{% url "chkDate" %}',#}
       {#                 headers: {#}
       {#                     'X-CSRFTOKEN': '{{ csrf_token }}'#}
       {#                 },#}
       {#                 dataType: 'json',#}
       {#                 success: function (data) {#}
       {#                     var list = data.chkDate#}
       {#                     var list2 = data.chkBank#}
       {#                     var list3 = data.chkAct#}
       {##}
       {##}
       {#                     var bank = "";#}
       {#                     var act = "";#}
       {#                     for (var j = 0; j < list2.length; j++) {#}
       {#                         bank = list[j][0]#}
       {#                     }#}
       {#                     for (var k = 0; k < list3.length; k++) {#}
       {#                         act = list[k][0]#}
       {##}
       {#                     }#}
       {##}
       {#                     if(data.chkDate != ''){#}
       {#                         date = list[0][0];#}
       {#                         gbn = list[0][1];#}
       {##}
       {#                         if(date < 10){#}
       {#                             date = '0' + date#}
       {#                         }#}
       {#                         if(date == 'last'){#}
       {#                             var now = new Date;#}
       {#                             date = now.getDate()#}
       {#                         }#}
       {##}
                                 {# 당월 #}
       {#                         if(gbn == '0'){#}
       {#                             var newDate = new Date;#}
       {#                             var year = newDate.getFullYear()#}
       {#                             var month = newDate.getMonth() + 1#}
       {#                             if(month > 12){#}
       {#                                 year = year + 1#}
       {#                                 month = '0' + (month - 12)#}
       {#                             }#}
       {#                             if(month < 10){#}
       {#                                 month = '0' + (month)#}
       {#                             }#}
       {#                             var exDate = year + "-" + month + "-" + date#}
       {##}
       {#                         }#}
                                {# 익월 #}
       {#                         if(gbn == '1'){#}
       {#                             var newDate = new Date;#}
       {#                             var year = newDate.getFullYear()#}
       {#                             var month = newDate.getMonth() + 2#}
       {#                             if(month > 12){#}
       {#                                 year = year + 1#}
       {#                                 month = '0' + (month - 12)#}
       {#                             }#}
       {#                             if(month < 10){#}
       {#                                 month = '0' + (month)#}
       {#                             }#}
       {#                             var exDate = year + "-" + month + "-" + date#}
       {##}
       {#                         }#}
       {##}
       {#                         document.getElementById("txtExDate").value = exDate;#}
       {##}
       {#                     }#}
       {#                     else{#}
       {#                         $("#txtExDate").val("");#}
       {#                     }#}
       {#                     $('.cboBank').hide();#}
       {#                     $('.cboAct').hide();#}
       {#                     document.getElementById('txtCustBank').value = bank;#}
       {#                     document.getElementById('txtCustAct').value = act;#}
       {#                 }#}
       {#             });#}
       {#         }#}
       {#     }#}
       {#});#}

        {# 계좌번호 선택시 계좌명 바인딩 #}
       {# $('#cboWitActNum').change(function () {#}
       {##}
       {#     var method = document.getElementById('cboWitMethod').value#}
       {#     var cardNum = "";#}
       {#     var custCode = document.getElementById('cboWitCust').value;#}
       {##}
       {#     let data2 = {"method": method, "cardNum": cardNum, "custCode": custCode}#}
       {##}
       {#     var date = 0;#}
       {#     var gbn = "";#}
       {#     if(method == '2'){#}
       {##}
       {#         if(custCode == ''){#}
       {#             alert('거래처를 선택해주세요.')#}
       {#             return false;#}
       {#         }#}
       {#         if(custCode != ''){#}
       {#             $.ajax({#}
       {#                 type: "post",#}
       {#                 data: data2,#}
       {#                 url: '{% url "chkDate" %}',#}
       {#                 headers: {#}
       {#                     'X-CSRFTOKEN': '{{ csrf_token }}'#}
       {#                 },#}
       {#                 dataType: 'json',#}
       {#                 success: function (data) {#}
       {#                     var list = data.chkDate#}
       {##}
       {#                     if(data.chkDate != ''){#}
       {#                         date = list[0][0];#}
       {#                         gbn = list[0][1];#}
       {##}
       {#                         if(date < 10){#}
       {#                             date = '0' + date#}
       {#                         }#}
       {#                         if(date == 'last'){#}
       {#                             var now = new Date;#}
       {#                             date = now.getDate()#}
       {#                         }#}
       {##}
       {#                           당월 #}
       {#                         if(gbn == '0'){#}
       {#                             var newDate = new Date;#}
       {#                             var year = newDate.getFullYear()#}
       {#                             var month = newDate.getMonth() + 1#}
       {#                             if(month > 12){#}
       {#                                 year = year + 1#}
       {#                                 month = '0' + (month - 12)#}
       {#                             }#}
       {#                             var exDate = year + "-" + month + "-" + date#}
       {#                         }#}
       {#                          익월 #}
       {#                         if(gbn == '1'){#}
       {#                             var newDate = new Date;#}
       {#                             var year = newDate.getFullYear()#}
       {#                             var month = newDate.getMonth() + 2#}
       {#                             if(month > 12){#}
       {#                                 year = year + 1#}
       {#                                 month = '0' + (month - 12)#}
       {#                             }#}
       {#                             var exDate = year + "-" + month + "-" + date#}
       {#                         }#}
       {##}
       {#                         $("#txtExDate").val(exDate);#}
       {##}
       {#                     }#}
       {#                     else{#}
       {#                         $("#txtExDate").val("");#}
       {#                     }#}
       {##}
       {#                 }#}
       {#             });#}
       {#         }#}
       {##}
       {#     }#}
       {#});#}


        {# 입/출금구분 선택시 #}
        $('#cboWitGbn').change(function () {

            var val = $(this).val();
            if(val == "1" || val == "2") {
                $('.basic').show();
                $('.method').show();
                $('.replace').hide();
                $('.line').show();

                if(val == '2'){
                    $('.cboCard').hide();
                }

                var cboWitCust2 = "";
                var cboAdminCode = "";
                var cboWitMethod = "";
                var cboWitActNum = "";
                var cboWitCustTxt = "<option value=''>:: 선택 ::</option>";
                var cboAdminCodeTxt = "<option value=''>:: 선택 ::</option>";
                var cboWitMethodTxt = "<option value=''>:: 선택 ::</option>";
                var cboWitActNumTxt = "<option value=''>:: 선택 ::</option>";

                $("#cboWitCust").html("");
                $("#cboAdminCode").html("");
                $("#cboWitMethod").html("");
                $("#cboWitActNum").html("");

                var cboGbn = document.getElementById('cboWitGbn').value

                var acIogb = "";
                var acDate = "";
                var acNum = "";
                var acCust = "";
                var acMcode = "";

                var data = {"cboGbn": cboGbn, 'acIogb': acIogb, 'acDate': acDate, 'acNum': acNum, "acCust": acCust, 'acMcode': acMcode}

                $.ajax({
                    type: "post",
                    url: '{% url "payment_search" %}',
                    data: data,
                    headers: {
                        'X-CSRFTOKEN': '{{ csrf_token }}'
                    },
                    dataType: 'json',
                    success: function (data) {
                        var combolist = data.cboCust;
                        for (var i = 0; i < combolist.length; i++) {
                            if (combolist[i][0] == cboWitCust2) {
                                cboWitCustTxt = cboWitCustTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][1] + "</option>";
                            } else {
                                cboWitCustTxt = cboWitCustTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][1] + "</option>";
                            }
                        }

                        var combolist3 = data.cboPay;
                        for (var i = 0; i < combolist3.length; i++) {
                            if (combolist3[i][0] == cboWitMethod) {
                                cboWitMethodTxt = cboWitMethodTxt + "<option value='" + combolist3[i][0] + "' selected>" + combolist3[i][1] + "</option>";
                            } else {
                                cboWitMethodTxt = cboWitMethodTxt + "<option value='" + combolist3[i][0] + "'>" + combolist3[i][1] + "</option>";
                            }
                        }

                        var combolist4 = data.cboMCode;
                        for (var i = 0; i < combolist4.length; i++) {
                            if (combolist4[i][0] == cboAdminCode) {
                                cboAdminCodeTxt = cboAdminCodeTxt + "<option value='" + combolist4[i][0] + "' selected>" + combolist4[i][1] + "</option>";
                            } else {
                                cboAdminCodeTxt = cboAdminCodeTxt + "<option value='" + combolist4[i][0] + "'>" + combolist4[i][1] + "</option>";
                            }
                        }

                        var combolist5 = data.cboAcnumber;
                        for (var i = 0; i < combolist5.length; i++) {
                            if (combolist5[i][0] == cboWitActNum) {
                                cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "' selected>" + combolist5[i][0] + "</option>";
                            } else {
                                cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "'>" + combolist5[i][0] + "</option>";
                            }
                        }

                        $("#cboWitCust").append(cboWitCustTxt);
                        $("#cboWitMethod").append(cboWitMethodTxt);
                        $("#cboAdminCode").append(cboAdminCodeTxt);
                        $("#cboWitActNum").append(cboWitActNumTxt);
                    }
                })
            } else if(val == "3") {
                $('.replace').show();
                $('.basic').hide();
                $('.method').hide();
                $('.line').hide();

                var cboOutAct = "";
                var cboOutBank = "";
                var cboInAct = "";
                var cboInBank = "";
                var cboOutActTxt = "<option value=''>:: 선택 ::</option>";
                var cboOutBankTxt = "<option value=''>:: 선택 ::</option>";
                var cboInActTxt = "<option value=''>:: 선택 ::</option>";
                var cboInBankTxt = "<option value=''>:: 선택 ::</option>";

                $("#cboOutAct").html("");
                $("#cboOutBank").html("");
                $("#cboInAct").html("");
                $("#cboInBank").html("");

                $.ajax({
                    type: "post",
                    url: '{% url "cboAct" %}',
                    headers: {
                        'X-CSRFTOKEN': '{{ csrf_token }}'
                    },
                    dataType: 'json',
                    success: function (data) {
                        var combolist = data.cboAct;
                        for (var i = 0; i < combolist.length; i++) {
                            if (combolist[i][0] == cboOutAct) {
                                cboOutActTxt = cboOutActTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][0] + "</option>";
                            } else {
                                cboOutActTxt = cboOutActTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][0] + "</option>";
                            }
                        }

                        var combolist2 = data.cboAct;
                        for (var i = 0; i < combolist2.length; i++) {
                            if (combolist2[i][0] == cboInAct) {
                                cboInActTxt = cboInActTxt + "<option value='" + combolist2[i][0] + "' selected>" + combolist2[i][0] + "</option>";
                            } else {
                                cboInActTxt = cboInActTxt + "<option value='" + combolist2[i][0] + "'>" + combolist2[i][0] + "</option>";
                            }
                        }

                        var combolist3 = data.cboBank;
                        for (var i = 0; i < combolist3.length; i++) {
                            if (combolist3[i][0] == cboOutBank) {
                                cboOutBankTxt = cboOutBankTxt + "<option value='" + combolist3[i][0] + "' selected>" + combolist3[i][1] + "</option>";
                            } else {
                                cboOutBankTxt = cboOutBankTxt + "<option value='" + combolist3[i][0] + "'>" + combolist3[i][1] + "</option>";
                            }
                        }

                        var combolist4 = data.cboBank;
                        for (var i = 0; i < combolist4.length; i++) {
                            if (combolist4[i][0] == cboInBank) {
                                cboInBankTxt = cboInBankTxt + "<option value='" + combolist4[i][0] + "' selected>" + combolist4[i][1] + "</option>";
                            } else {
                                cboInBankTxt = cboInBankTxt + "<option value='" + combolist4[i][0] + "'>" + combolist4[i][1] + "</option>";
                            }
                        }

                        $("#cboOutAct").append(cboOutActTxt);
                        $("#cboOutBank").append(cboOutBankTxt);
                        $("#cboInAct").append(cboInActTxt);
                        $("#cboInBank").append(cboInBankTxt);
                    }
                })
            }

        });

        {# 카드 선택시 계좌명 바인딩 #}
        {#$('#cboWitCard').change(function () {#}
        {##}
        {#    var cboWitActNum = "";#}
        {#    var cboWitActNumTxt = "";#}
        {##}
        {#    $("#cboWitActNum").html("");#}
        {##}
        {#    var cboCard = document.getElementById('cboWitCard').value#}
        {#    var cboGbn = "";#}
        {#    var acIogb = "";#}
        {#    var acDate = "";#}
        {#    var acNum = "";#}
        {#    var acCust = "";#}
        {#    var acMcode = "";#}
        {##}
        {#    var data = {"cboGbn": cboGbn, 'acIogb': acIogb, 'acDate': acDate, 'acNum': acNum, "acCust": acCust, 'acMcode': acMcode, 'cboCard': cboCard}#}
        {##}
        {##}
        {#    $.ajax({#}
        {#        type: "post",#}
        {#        url: '{% url "payment_search" %}',#}
        {#        data: data,#}
        {#        headers: {#}
        {#            'X-CSRFTOKEN': '{{ csrf_token }}'#}
        {#        },#}
        {#        dataType: 'json',#}
        {#        success: function (data) {#}
        {##}
        {#            var combolist5 = data.cboActNum;#}
        {#            for (var i = 0; i < combolist5.length; i++) {#}
        {#                if (combolist5[i][0] == cboWitActNum) {#}
        {#                    cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "' selected>" + combolist5[i][0] + "</option>";#}
        {#                } else {#}
        {#                    cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "'>" + combolist5[i][0] + "</option>";#}
        {#                }#}
        {#            }#}
        {##}
        {#            $("#cboWitActNum").append(cboWitActNumTxt);#}
        {##}
        {#                var date = "";#}
        {#                var now = new Date;#}
        {#                var yyyymmdd = new Date(now.getFullYear(), now.getMonth()+ 1, 0)#}
        {#                var yyyy = String(yyyymmdd.getFullYear());#}
        {#                var mm = String(yyyymmdd.getMonth()+1);#}
        {#                var nowDD = String(yyyymmdd.getDate());#}
        {#                var dd = String(data.cboCard);#}
        {#                if(dd > nowDD){#}
        {#                    date = yyyy + '-' + mm + '-' + nowDD;#}
        {#                }#}
        {#                else{#}
        {#                    date = yyyy + '-' + mm + '-' + dd;#}
        {#                }#}
        {##}
        {#                document.getElementById('txtExDate').value = date;#}
        {#        }#}
        {#    })#}
        {##}
        {#});#}

        {# 출금 계좌 계좌명 바인딩 #}
        $('#cboOutBank').change(function () {
            var cboOutAct = "";
            var cboOutActTxt = "";

            $("#cboOutAct").html("");

            var cboBank = document.getElementById('cboOutBank').value

            let data = {'cboBank': cboBank}

            $.ajax({
                type: "post",
                data: data,
                url: '{% url "cboAct" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {
                    var combolist = data.cboAct;
                    for (var i = 0; i < combolist.length; i++) {
                        if (combolist[i][0] == cboOutAct) {
                            cboOutActTxt = cboOutActTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][0] + "</option>";
                        } else {
                            cboOutActTxt = cboOutActTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][0] + "</option>";
                        }
                    }

                    $("#cboOutAct").append(cboOutActTxt);
                }
            })
        });

        {# 입금 계좌 계좌명 바인딩 #}
        $('#cboInBank').change(function () {
            var cboInAct = "";
            var cboInActTxt = "";

            $("#cboInAct").html("");

            var cboBank = document.getElementById('cboInBank').value

            let data = {'cboBank': cboBank}

            $.ajax({
                type: "post",
                data: data,
                url: '{% url "cboAct" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {

                    var combolist2 = data.cboAct;
                    for (var i = 0; i < combolist2.length; i++) {
                        if (combolist2[i][0] == cboInAct) {
                            cboInActTxt = cboInActTxt + "<option value='" + combolist2[i][0] + "' selected>" + combolist2[i][0] + "</option>";
                        } else {
                            cboInActTxt = cboInActTxt + "<option value='" + combolist2[i][0] + "'>" + combolist2[i][0] + "</option>";
                        }
                    }

                    $("#cboInAct").append(cboInActTxt);
                }
            })
        });

        {# 이미지 삭제 버튼 클릭 #}
        $('#btnImgDlt').click(function() {
            $('#fileNm').empty();
            $('#file').val("");

            var origin_img_url = $('#itemimage').data('origin');
            $('#itemimage').attr('src', origin_img_url);
        });

        //파일선택창에서 이미지 선택 후 확인 누르면 그 동시에 발생하는 이벤트
        $('#file').change(function(event) {
            var file = event.target.files[0]

            $('#fileNm').text(file.name);

            var reader = new FileReader(); //1

            reader.onload = function(e) {
                $('#file').attr('src', e.target.result); //3
            }

            reader.readAsDataURL(file); //2
        });

        {# 저장 버튼 #}
        $(document).on('click', "#btnSave", function () {

            var formData = new FormData($('#formzone')[0]);

            var cboWitGbn = document.getElementById('cboWitGbn').value
            var cboWitMethod = document.getElementById('cboWitMethod').value
            var txtTitle = document.getElementById('txtTitle').value
            var txtWhere = document.getElementById('txtWhere').value
            var cboWitCust = document.getElementById('cboWitCust').value
            var txtCustName = document.getElementById('txtCustName').value
            var txtWitRegDate = document.getElementById('txtWitRegDate').value
            var txtExDate = document.getElementById('txtExDate').value
            var cboAdminCode = document.getElementById('cboAdminCode').value
            var txtWitPrice = document.getElementById('txtWitPrice').value
            var cboWitActNum = document.getElementById('cboWitActNum').value
            var txtApplyDate = document.getElementById('txtApplyDate').value
            var cboWitCard = document.getElementById('cboWitCard').value
            var txtWitRemark = document.getElementById('txtWitRemark').value
            var txtApvAll = document.getElementById('txtApvAll').value
            var txtInfo = document.getElementById('txtInfo').value
            var txtCashDate = document.getElementById('txtCashDate').value


            {# 현금 #}
            if(cboWitMethod == '1'){
                if(txtWitRegDate == ''){
                    alert('사용 일자를 입력해주세요.')
                    return false;
                }
                if(cboAdminCode == ''){
                    alert('관리 계정을 입력해주세요.')
                    return false;
                }
                if(txtTitle == ''){
                    alert('제목을 입력해주세요.')
                    return false;
                }
                if(txtWhere == ''){
                    alert('사용처를 입력해주세요.')
                    return false;
                }
                if(txtWitPrice == ''){
                    alert('금액을 입력해주세요.')
                    return false;
                }
                if(txtApplyDate == ''){
                    alert('적용 년월을 선택해주세요.')
                    return false;
                }
                if(txtWitRemark == ''){
                    alert('세부 내용을 입력해주세요.')
                    return false;
                }
                if(txtInfo == ''){
                    alert('수령인 정보를 입력해주세요.')
                    return false;
                }
                if(txtCashDate == ''){
                    alert('지급 요청일을 선택해주세요.')
                    return false;
                }
            }
            {# 계산서 #}
            if(cboWitMethod == '2'){
                if(txtWitRegDate == ''){
                    alert('발행 일자를 입력해주세요.')
                    return false;
                }
                if(cboAdminCode == ''){
                    alert('관리 계정을 입력해주세요.')
                    return false;
                }
                if(txtTitle == ''){
                    alert('제목을 입력해주세요.')
                    return false;
                }
                if(cboWitCust == ''){
                    alert('거래처를 선택해주세요.')
                    return false;
                }
                if(txtWitPrice == ''){
                    alert('금액을 입력해주세요.')
                    return false;
                }
                if(txtApplyDate == ''){
                    alert('적용 년월을 선택해주세요.')
                    return false;
                }
                if(txtExDate == ''){
                    alert('결재 예정 일자를 선택해주세요.')
                    return false;
                }
                if(txtWitRemark == ''){
                    alert('세부 내용을 입력해주세요.')
                    return false;
                }
            }
            {# 신용카드 #}
            if(cboWitMethod == '3' || cboWitMethod == '4'){
                if(txtWitRegDate == ''){
                    alert('사용 일자를 입력해주세요.')
                    return false;
                }
                if(cboAdminCode == ''){
                    alert('관리 계정을 입력해주세요.')
                    return false;
                }
                if(txtTitle == ''){
                    alert('제목을 입력해주세요.')
                    return false;
                }
                if(txtWhere == ''){
                    alert('사용처를 입력해주세요.')
                    return false;
                }
                if(txtWitPrice == ''){
                    alert('금액을 입력해주세요.')
                    return false;
                }
                if(cboWitCard == ''){
                    alert('카드를 선택해주세요.')
                    return false;
                }
                if(txtApplyDate == ''){
                    alert('적용 년월을 선택해주세요.')
                    return false;
                }
                if(txtExDate == ''){
                    alert('결재 예정 일자를 선택해주세요.')
                    return false;
                }
                if(txtWitRemark == ''){
                    alert('세부 내용을 입력해주세요.')
                    return false;
                }
            }
            {# 이체 #}
            {#if(cboWitMethod == '4'){#}
            {#    if(txtWitRegDate == ''){#}
            {#        alert('사용 일자를 입력해주세요.')#}
            {#        return false;#}
            {#    }#}
            {#    if(cboAdminCode == ''){#}
            {#        alert('관리 계정을 입력해주세요.')#}
            {#        return false;#}
            {#    }#}
            {#    if(txtTitle == ''){#}
            {#        alert('제목을 입력해주세요.')#}
            {#        return false;#}
            {#    }#}
            {#    if(txtWhere == ''){#}
            {#        alert('사용처를 입력해주세요.')#}
            {#        return false;#}
            {#    }#}
            {#    if(txtWitPrice == ''){#}
            {#        alert('금액을 입력해주세요.')#}
            {#        return false;#}
            {#    }#}
            {#    if(txtApplyDate == ''){#}
            {#        alert('적용 년월을 선택해주세요.')#}
            {#        return false;#}
            {#    }#}
            {#    if(txtWitRemark == ''){#}
            {#        alert('세부 내용을 입력해주세요.')#}
            {#        return false;#}
            {#    }#}
            {#    if(txtCashDate == ''){#}
            {#        alert('지급 요청일을 선택해주세요.')#}
            {#        return false;#}
            {#    }#}
            {#}#}


            var empArr = [];
            for (var i = 0; i < 10; i++) {

                var empNbr = $('#subEmpNbr_' + i).text();

                if(empNbr){
                    let data = {
                        'empNbr': empNbr
                    };
                    empArr.push(data);
                }
            }

            if(txtApvAll == '' && empArr == ''){
                alert('결재라인을 지정해주세요.')
                return false;
            }


            {# 가로로 펼쳐진 td 갯수만큼 받아서 돌리기 #}
            if(cboWitGbn == '3'){
                {#const subCount = $('#signTd tr').length;#}

                var outAct = document.getElementById('cboOutAct').value
                var inAct = document.getElementById('cboInBank').value
                if(outAct == ''){
                    alert('출금 계좌를 선택해주세요.')
                    return false
                }
                if(inAct == ''){
                    alert('입금 계좌를 선택해주세요.')
                    return false
                }

                if(txtApvAll == '100'){
                    var apvresult = confirm("전결건입니다. 저장하시겠습니까?")
                    if(apvresult == true){
                        var empArr = [];
                        for (var i = 0; i < 10; i++) {

                            var empNbr = $('#subEmpNbr_' + i).text();

                            if(empNbr){
                                let data = {
                                    'empNbr': empNbr
                                };
                                empArr.push(data);
                            }
                        }
                        formData.append('empArrList', JSON.stringify(empArr))

                        $.ajax({
                            type: "post",
                            data: formData,
                            cache: false,
                            contentType: false,
                            processData: false,
                            dataType: "json",
                            url: '{% url "offSet_save" %}',
                            headers: {
                                'X-CSRFTOKEN': '{{ csrf_token }}'
                            },
                            success: function (data) {
                                if (data.sucYn === 'Y') {
                                    alert('저장 되었습니다.')
                                    location.href = "{% url 'with_reg_sheet' %}";
                                }
                                else if(data.sucYn === 'N' && data.message == 'same file name exists') {

                                    formData.append('fileOverwriteYn', 'Y');

                                    $.ajax({
                                        type: "post",
                                        data: formData,
                                        cache: false,
                                        contentType: false,
                                        processData: false,
                                        dataType: "json",
                                        url: '{% url "offSet_save" %}',
                                        headers: {
                                            'X-CSRFTOKEN': '{{ csrf_token }}'
                                        },
                                        success: function (data) {
                                            if (data.sucYn === 'Y') {
                                                alert('저장 되었습니다.')
                                                location.href = "{% url 'with_reg_sheet' %}";
                                            }
                                        }
                                    });

                                    {#if(confirm('동일한 파일명이 존재합니다. 덮어쓰시겠습니까?')) {#}
                                    {##}
                                    {#}#}
                                }
                            }
                        });
                    }
                    if(apvresult == false){
                    alert('취소되었습니다.')
                     return false;
                    }
                }
                else{
                    var empArr = [];
                    for (var i = 0; i < 10; i++) {

                        var empNbr = $('#subEmpNbr_' + i).text();

                        if(empNbr){
                            let data = {
                                'empNbr': empNbr
                            };
                            empArr.push(data);
                        }
                    }

                    formData.append('empArrList', JSON.stringify(empArr))

                    var saveresult = confirm("저장하시겠습니까?")

                    if(saveresult == true){
                        $.ajax({
                            type: "post",
                            data: formData,
                            cache: false,
                            contentType: false,
                            processData: false,
                            dataType: "json",
                            url: '{% url "offSet_save" %}',
                            headers: {
                                'X-CSRFTOKEN': '{{ csrf_token }}'
                            },
                            success: function (data) {
                                if (data.sucYn === 'Y') {
                                    alert('저장 되었습니다.')
                                    location.href = "{% url 'with_reg_sheet' %}";
                                }
                                else if(data.sucYn === 'N' && data.message == 'same file name exists') {

                                    formData.append('fileOverwriteYn', 'Y');

                                    $.ajax({
                                        type: "post",
                                        data: formData,
                                        cache: false,
                                        contentType: false,
                                        processData: false,
                                        dataType: "json",
                                        url: '{% url "offSet_save" %}',
                                        headers: {
                                            'X-CSRFTOKEN': '{{ csrf_token }}'
                                        },
                                        success: function (data) {
                                            if (data.sucYn === 'Y') {
                                                alert('저장 되었습니다.')
                                                location.href = "{% url 'with_reg_sheet' %}";
                                            }
                                        }
                                    });

                                    {#if(confirm('동일한 파일명이 존재합니다. 덮어쓰시겠습니까?')) {#}
                                    {##}
                                    {#}#}
                                }
                            }
                        });
                    }
                    if(saveresult == false){
                        alert('취소되었습니다.')
                         return false;
                    }
                }
            }
            else{
                {# 전결 저장 #}
                if(txtApvAll == '100'){
                    var apvresult = confirm("전결건입니다. 저장하시겠습니까?")
                    if(apvresult == true){
                        var empArr = [];
                        for (var i = 0; i < 10; i++) {

                            var empNbr = $('#subEmpNbr_' + i).text();
                            if(empNbr){
                                let data = {
                                    'empNbr': empNbr
                                };
                                empArr.push(data);
                            }
                        }
                        formData.append('empArrList', JSON.stringify(empArr))

                        $.ajax({
                            type: "post",
                            data: formData,
                            cache: false,
                            contentType: false,
                            processData: false,
                            dataType: "json",
                            url: '{% url "payment_save" %}',
                            headers: {
                                'X-CSRFTOKEN': '{{ csrf_token }}'
                            },
                            success: function (data) {
                                if (data.sucYn === 'Y') {
                                    alert('저장 되었습니다.')
                                    location.href = "{% url 'with_reg_sheet' %}";
                                }
                                else if(data.sucYn === 'N' && data.message == 'same file name exists') {

                                    formData.append('fileOverwriteYn', 'Y');
                                    $.ajax({
                                        type: "post",
                                        data: formData,
                                        cache: false,
                                        contentType: false,
                                        processData: false,
                                        dataType: "json",
                                        url: '{% url "payment_save" %}',
                                        headers: {
                                            'X-CSRFTOKEN': '{{ csrf_token }}'
                                        },
                                        success: function (data) {
                                            if (data.sucYn === 'Y') {
                                                alert('저장 되었습니다.')
                                                location.href = "{% url 'with_reg_sheet' %}";
                                            }
                                        }
                                    });
                                    {#if(confirm('동일한 파일명이 존재합니다. 덮어쓰시겠습니까?')) {#}
                                    {##}
                                    {#}#}
                                }
                            }
                        });
                    }
                    if(apvresult == false){
                        alert('취소되었습니다.')
                        return false;
                    }
                }
                else{
                    var empArr = [];
                    for (var i = 0; i < 10; i++) {

                        var empNbr = $('#subEmpNbr_' + i).text();
                        if(empNbr){
                            let data = {
                                'empNbr': empNbr
                            };
                            empArr.push(data);
                        }
                    }


                    formData.append('empArrList', JSON.stringify(empArr))

                    var saveresult = confirm("저장하시겠습니까?")

                    if(saveresult == true){
                        $.ajax({
                            type: "post",
                            data: formData,
                            cache: false,
                            contentType: false,
                            processData: false,
                            dataType: "json",
                            url: '{% url "payment_save" %}',
                            headers: {
                                'X-CSRFTOKEN': '{{ csrf_token }}'
                            },
                            success: function (data) {
                                if (data.sucYn === 'Y') {
                                    alert('저장 되었습니다.')
                                    location.href = "{% url 'with_reg_sheet' %}";
                                }
                                else if(data.sucYn === 'N' && data.message == 'same file name exists') {

                                    formData.append('fileOverwriteYn', 'Y');
                                    $.ajax({
                                        type: "post",
                                        data: formData,
                                        cache: false,
                                        contentType: false,
                                        processData: false,
                                        dataType: "json",
                                        url: '{% url "payment_save" %}',
                                        headers: {
                                            'X-CSRFTOKEN': '{{ csrf_token }}'
                                        },
                                        success: function (data) {
                                            if (data.sucYn === 'Y') {
                                                alert('저장 되었습니다.')
                                                location.href = "{% url 'with_reg_sheet' %}";
                                            }
                                        }
                                    });
                                    {#if(confirm('동일한 파일명이 존재합니다. 덮어쓰시겠습니까?')) {#}
                                    {##}
                                    {#}#}
                                }
                            }
                        });
                    }
                    if(saveresult == false){
                        alert('취소되었습니다.')
                        return false;
                    }
                }
            }

        });

        {#$('input[name=txtWitPrice]').on('input', function () {#}
        {#    var txtRegNum = $(this).val();#}
        {##}
            {#var regex_txtRegNum = txtRegNum.replace(/[^0-9]/g, '').replace(/^(\d{0,3})(\d{0,3})(\d{0,3})(\d{0,3})(\d{0,3})$/g, "$1,$2,$3,$4,$5").replace(/\-{1,5}$/g, "");#}
        {#    var regex_txtRegNum = txtRegNum.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")#}
        {#    $(this).val(regex_txtRegNum);#}
        {#});#}
        {##}
        {#$('input[name=txtWitPrice2]').on('input', function () {#}
        {#    var txtRegNum = $(this).val();#}
        {##}
        {#    var regex_txtRegNum = txtRegNum.replace(/[^0-9]/g, '').replace(/^(\d{0,3})(\d{0,2})(\d{0,5})$/g, "$1-$2-$3").replace(/\-{1,2}$/g, "");#}
        {#    $(this).val(regex_txtRegNum);#}
        {#});#}


        {#기존소스#}
        {#$('input[name=txtWitPrice]').on('input', function () {#}
        {#    var txtRegNum = Number($(this).val().replaceAll(',',''));#}
        {##}
        {#    if(isNaN(txtRegNum)) {#}
        {#        txtRegNum = 0;#}
        {#    }#}
        {##}
        {#    var regex_txtRegNum = txtRegNum.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");#}
        {#    $(this).val(regex_txtRegNum);#}
        {##}
        {#});#}


        $('input[name=txtWitPrice]').on('input', function () {
            var txtRegNum = $(this).val().replaceAll(',','');

            if(txtRegNum != '-' && isNaN(Math.abs(txtRegNum))) {
                txtRegNum = 0;
            }

            {#var regex_txtRegNum = txtRegNum.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");#}
            var regex_txtRegNum = txtRegNum.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,");
            $(this).val(regex_txtRegNum);

        });

        {# 조회 초기화 버튼 #}
        $(document).on('click', "#btnClear2", function () {

            var inputAct = "";
            var inputPayGbn = "";
            var inputActTxt = "<option value=''>:: 선택 ::</option>";
            var inputPayGbnTxt = "<option value=''>:: 선택 ::</option>";

            $("#inputAct").html("");
            $("#inputPayGbn").html("");
            $("#inputGbn").val("");
            $("#inputEmpName").val("");
            $("#inputCustName").val("");
            $("#inputCust").val("");

            var date = new Date();
            date.setMonth(date.getMonth() - 3);

            document.getElementById("inputStrDate").valueAsDate = date;
            document.getElementById("inputEndDate").valueAsDate = new Date;

            var gbn = "";

            let data = {"gbn": gbn}

            $.ajax({
                type: "post",
                data: data,
                url: '{% url "cboList" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {

                    var combolist3 = data.cboPay;
                    for (var i = 0; i < combolist3.length; i++) {
                        if (combolist3[i][0] == inputPayGbn) {
                            inputPayGbnTxt = inputPayGbnTxt + "<option value='" + combolist3[i][0] + "' selected>" + combolist3[i][1] + "</option>";
                        } else {
                            inputPayGbnTxt = inputPayGbnTxt + "<option value='" + combolist3[i][0] + "'>" + combolist3[i][1] + "</option>";
                        }
                    }

                    var combolist5 = data.cboAcnumber;
                    for (var i = 0; i < combolist5.length; i++) {
                        if (combolist5[i][0] == inputAct) {
                            inputActTxt = inputActTxt + "<option value='" + combolist5[i][0] + "' selected>" + combolist5[i][0] + "</option>";
                        } else {
                            inputActTxt = inputActTxt + "<option value='" + combolist5[i][0] + "'>" + combolist5[i][0] + "</option>";
                        }
                    }

                    $("#inputPayGbn").append(inputPayGbnTxt);
                    $("#inputAct").append(inputActTxt);

                }
            });
        });


        {# 초기화 버튼 #}
        $(document).on('click', "#btnClear", function () {

            $('#file_name').empty();
            $("#txtTitle").attr("readonly",false);
            $("#txtWitRegDate").attr("readonly",false);
            $("#txtWitSeq").attr("readonly",false);
            $("#txtWitRecn").attr("readonly",false);
            $("#txtWitPrice").attr("readonly",false);
            $("#txtWitCashNum").attr("readonly",false);
            $("#txtWitRemark").attr("readonly",false);
            $("#txtExDate").attr("readonly",false);
            $("#txtCashDate").attr("readonly",false);
            $("#txtInfo").attr("readonly",false);
            $("#txtWhere").attr("readonly",false);
            $("#txtApplyDate").attr("readonly",false);
            $("#txtCashDate").attr("readonly",false);
            $("#cboWitGbn").attr("disabled",false);
            $("#cboWitMethod").attr("disabled",false);
            $("#cboWitCust").attr("disabled",false);
            $("#cboAdminCode").attr("disabled",false);
            $("#cboWitActNum").attr("disabled",false);
            $("#cboWitCard").attr("disabled",false);
            $("#cboBank").attr("disabled",false);
            $("#cboCardName").attr("disabled",false);


            var inputBank = "";
            var cboCust = "";
            var cboAct = "";
            var cboWitCust2 = "";
            var cboWitGbn = "";
            var cboAdminCode = "";
            var cboWitMethod = "";
            var cboWitActNum = "";
            var cboWitCard = "";
            var cboBank = "";
            var cboCardName = "";
            var inputBankTxt = "<option value=''>:: 선택 ::</option>";
            var cboCustTxt = "<option value=''>:: 선택 ::</option>";
            var cboActTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitCustTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitGbnTxt = "";
            var cboAdminCodeTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitMethodTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitActNumTxt = "<option value=''>:: 선택 ::</option>";
            var cboWitCardTxt = "<option value=''>:: 선택 ::</option>";
            var cboBankTxt = "<option value=''>:: 선택 ::</option>";
            var cboCardNameTxt = "<option value=''>:: 선택 ::</option>";


            $("#txtWitPrice").val("");
            $("#txtCustName").val("");
            $("#cboWitCust").html("");
            $("#cboWitGbn").html("");
            $("#cboAdminCode").html("");
            $("#cboWitMethod").html("");
            $("#cboWitActNum").html("");
            $("#cboWitCard").html("");
            $("#cboBank").html("");
            $("#cboCardName").html("");
            $("#txtWitRegDate").val("");
            $("#txtWitSeq").val("");
            $("#txtWitRecn").val("");
            $("#txtExDate").val("");
            $("#txtCashDate").val("");
            $("#txtWitPrice").val("");
            $("#txtWitCashNum").val("");
            $("#txtWitRemark").val("");
            $("#txtTitle").val("");
            $("#txtInfo").val("");
            $("#txtApplyDate").val("");
            $("#txtWhere").val("");
            $("#txtCreUser").val("");
            $("#txtCashDate").val("");
            $("#txtApvAll").val("");
            $('.creUser').hide();
            $(`#chkPre`).prop("checked",false);

            var gbn = '1'

            let data = {"gbn": gbn}

            $.ajax({
                type: "post",
                data: data,
                url: '{% url "cboList" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {

                    var combolist = data.cboCust;
                    for (var i = 0; i < combolist.length; i++) {
                        if (combolist[i][0] == cboWitCust2) {
                            cboWitCustTxt = cboWitCustTxt + "<option value='" + combolist[i][0] + "' selected>" + combolist[i][1] + "</option>";
                        } else {
                            cboWitCustTxt = cboWitCustTxt + "<option value='" + combolist[i][0] + "'>" + combolist[i][1] + "</option>";
                        }
                    }

                    var combolist2 = data.cboGgn;
                    for (var i = 0; i < combolist2.length; i++) {
                        if (combolist2[i][0] == cboWitGbn) {
                            cboWitGbnTxt = cboWitGbnTxt + "<option value='" + combolist2[i][0] + "' selected>" + combolist2[i][1] + "</option>";
                        } else {
                            cboWitGbnTxt = cboWitGbnTxt + "<option value='" + combolist2[i][0] + "'>" + combolist2[i][1] + "</option>";
                        }
                    }

                    var combolist3 = data.cboPay;
                    for (var i = 0; i < combolist3.length; i++) {
                        if (combolist3[i][0] == cboWitMethod) {
                            cboWitMethodTxt = cboWitMethodTxt + "<option value='" + combolist3[i][0] + "' selected>" + combolist3[i][1] + "</option>";
                        } else {
                            cboWitMethodTxt = cboWitMethodTxt + "<option value='" + combolist3[i][0] + "'>" + combolist3[i][1] + "</option>";
                        }
                    }

                    var combolist4 = data.cboMCode;
                    for (var i = 0; i < combolist4.length; i++) {
                        if (combolist4[i][0] == cboAdminCode) {
                            cboAdminCodeTxt = cboAdminCodeTxt + "<option value='" + combolist4[i][0] + "' selected>" + combolist4[i][1] + "</option>";
                        } else {
                            cboAdminCodeTxt = cboAdminCodeTxt + "<option value='" + combolist4[i][0] + "'>" + combolist4[i][1] + "</option>";
                        }
                    }

                    var combolist5 = data.cboAcnumber;
                    for (var i = 0; i < combolist5.length; i++) {
                        if (combolist5[i][0] == cboWitActNum) {
                            cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "' selected>" + combolist5[i][0] + "</option>";
                        } else {
                            cboWitActNumTxt = cboWitActNumTxt + "<option value='" + combolist5[i][0] + "'>" + combolist5[i][0] + "</option>";
                        }
                    }

                    var combolist6 = data.cboCard;
                    for (var i = 0; i < combolist6.length; i++) {
                        if (combolist6[i][0] == cboWitCard) {
                            cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist6[i][0] + "' selected>" + combolist6[i][0] + "</option>";
                        } else {
                            cboWitCardTxt = cboWitCardTxt + "<option value='" + combolist6[i][0] + "'>" + combolist6[i][0] + "</option>";
                        }
                    }

                    var combolist7 = data.cboBank;
                    for (var i = 0; i < combolist7.length; i++) {
                        if (combolist7[i][0] == cboBank) {
                            cboBankTxt = cboBankTxt + "<option value='" + combolist7[i][0] + "' selected>" + combolist7[i][1] + "</option>";
                        } else {
                            cboBankTxt = cboBankTxt + "<option value='" + combolist7[i][0] + "'>" + combolist7[i][1] + "</option>";
                        }
                    }

                    var combolist8 = data.cardName;
                    for (var i = 0; i < combolist8.length; i++) {
                        if (combolist8[i][0] == cboCardName) {
                            cboCardNameTxt = cboCardNameTxt + "<option value='" + combolist8[i][0] + "' selected>" + combolist8[i][1] + "</option>";
                        } else {
                            cboCardNameTxt = cboCardNameTxt + "<option value='" + combolist8[i][0] + "'>" + combolist8[i][1] + "</option>";
                        }
                    }

                    $("#cboWitCust").append(cboWitCustTxt);
                    $("#cboWitGbn").append(cboWitGbnTxt);
                    $("#cboWitMethod").append(cboWitMethodTxt);
                    $("#cboAdminCode").append(cboAdminCodeTxt);
                    $("#cboWitActNum").append(cboWitActNumTxt);
                    $("#cboWitCard").append(cboWitCardTxt);
                    $("#cboBank").append(cboBankTxt);
                    $("#cboCardName").append(cboCardNameTxt);
                    $('.folderArea').show();
                    $('.apvArea').show();
                    }
            });

            _flag = false;
            $("#modalMainTd").html("");
            $("#modalSubTd").html("");
            $("#subTb").html("");

        });

        function checkOnlyOne(element) {

          const checkboxes
              = document.getElementsByName("chkWith[]");

          checkboxes.forEach((cb) => {
            cb.checked = false;
          })

          element.checked = true;
        }

         // 마우스 오버
        $(document).on('mouseover', '#grid tr', function() {
            $(this).addClass('bg-gray-100');
        });

        // 마우스 아웃
        $(document).on('mouseout', '#grid tr', function() {
            $(this).removeClass('bg-gray-100');
        });

        {#체크한 내용 삭제#}
        $(document).on('click', "#btnDlt", function () {

            var chk_cust_id_arr = [];
            $('input[name="chkWith[]"]:checked').each(function (i) {
                chk_cust_id_arr.push($(this).val());
            })

            //체크가 1개라도 안되있을때
            let chk_count = $("input[name='chkWith[]']").filter(":checked").length;
            if (chk_count < 1) {
                alert('삭제하실 원장을 체크 해주세요.');
                return false;
            }

            $.ajax({
                type: "post",
                async: false,
                data: {
                    'arrList': JSON.stringify(chk_cust_id_arr),
                },
                url: '{% url "payment_dlt_check" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {
                    if (data.YN === 'Y') {
                        alert('결재 진행된 건은 삭제 할 수 없습니다.')
                        return false;
                    }
                    else{
                        //체크 한 거래처 삭제
                        var result = confirm("삭제하시겠습니까?")

                        if (result) {
                            if (chk_cust_id_arr.length > 0)

                                $.ajax({
                                    type: "post",
                                    async: false,
                                    data: {
                                        'arrList': JSON.stringify(chk_cust_id_arr),
                                    },
                                    dataType: "json",
                                    url: '{% url "payment_dlt" %}',
                                    headers: {
                                        'X-CSRFTOKEN': '{{ csrf_token }}'
                                    },
                                    success: function (data) {
                                        location.href = "{% url 'with_reg_sheet' %}";

                                    }

                                });
                        } else {
                            alert('취소되었습니다.')
                            return false;
                        }
                    }
                }
            })
        });

        {# 만기일자 앤터시 input으로 이동 #}
        $('input[type="number"]').keydown(function (event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                if (event.currentTarget.id === 'txtWitPrice') {

                var price = document.getElementById('txtWitPrice').value;
                var sDate = document.getElementById('txtWitRegDate').value;
                var date = sDate.replace(/\-/g, '')

                let data = {'price': price, 'date': date}

                $.ajax({
                    type: "post",
                    data: data,
                    url: '{% url "checkLimit" %}',
                    headers: {
                        'X-CSRFTOKEN': '{{ csrf_token }}'
                    },
                    dataType: 'json',
                    success: function (data) {
                        if (data.YN === 'N') {
                            document.getElementById('warning').value = '요청하신 결제 금액이 많습니다.'
                        }
                        else{

                        }
                    }
                })
                }
            }
        });


        {# 엑셀 버튼 누를시 #}
        $(document).on('click', '#btnExcel', function () {
            var mergedTable = $('<table></table>');
            $('#grid').each(function () {
                $(this).find('tr').each(function (row, tr) {
                    var mergedRow = $('<tr></tr>');

                    $(tr).find('th:not(.excel-hidden), td:not(.excel-hidden)').each(function (col, td) {
                        var input = $(td).find('input');
                        var text = input.length > 0 ? input.val() : $(td).text();
                        $('<td>' + text + '</td>').appendTo(mergedRow);
                    });

                    mergedRow.appendTo(mergedTable);
                });
            });
            mergedTable.table2excel({
                name: 'Sheet1',
                filename: '거래처원장.xls',
            });
        });

        $('input[type="text"]').keydown(function (event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                if (event.currentTarget.id === 'txtCustName') {

                    if ($("#txtCustName").val().length == 0) {
                        alert("거래처명 한 글자 이상 입력 후 엔터를 쳐주세요.")
                        return false
                    } else {
                        let thisVal = $("#txtCustName").val();
                        let gbnVal = '1';
                        let url = '{% url 'popup_cust' %}';
                        openPop(url + '?val=' + thisVal + '&gbnVal=' + gbnVal, '거래처검색창');
                    }

                }
            }
        });

        $('input[type="text"]').keydown(function (event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                if (event.currentTarget.id === 'inputCustName') {

                    if ($("#inputCustName").val().length == 0) {
                        alert("거래처명 한 글자 이상 입력 후 엔터를 쳐주세요.")
                        return false
                    } else {
                        let thisVal = $("#inputCustName").val();
                        let gbnVal = '0';
                        let url = '{% url 'popup_cust' %}';
                        openPop(url + '?val=' + thisVal + '&gbnVal=' + gbnVal, '거래처검색창');
                    }

                }
            }
        });
    </script>



{% endblock %}