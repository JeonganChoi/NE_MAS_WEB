{% extends "layouts/base.html" %}

{% block title %} 결재 및 승인 등록 {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
{#         style="background-image: url('/static/assets/img/header-blue-purple.jpg'); background-position: bottom;"#}
    <div class="height-100"
         style="background-image: url('/static/assets/img/header-blue-purple.jpg'); background-position: bottom;"></div>
    <div class="container-fluid py-1 my-2">
        <div class="row mt-n7">
            <div class="col-lg-12">
                <div class="card blur border border-white rounded-2 shadow-xs">
                    <div class="card-body pb-2">
                        <div class="row">
                            <div class="col-lg-6 col-6 text-start">
                                <h4 class="text-dark font-weight-bold"><i class="fas fa-credit-card fas-4 me-3"></i>결재 및 승인 등록</h4>
                            </div>
                            <div class="col-lg-6 col-6 text-end">
                                <button type="button" class="btn btn-sm btn-primary text-white text-sm" id="btnSave" name="btnSave">저 장</button>
                                <button type="button" class="btn btn-sm btn-linkedin text-white text-sm" id="btnClear" name="btnClear">초기화</button>
                                <button type="button" class="btn btn-sm btn-light text-dark text-sm" id="btnDlt" name="btnDlt">삭제</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12 col-12">
                <div class="card border border-white shadow-xs height-600">
                    <div class="card-header pb-0">
                        <div class="row p-0">
                            <!--<div class="col-lg-3 col-3">
                              <div class="input-group shadow-none">
                                  <label style="font-size: 0.85rem; width: 4rem"><i class="fas fa-search me-2"></i>일자</label>
                                  <input class="form-control border border-light rounded-1 text-center me-2" type="date" name="inputStrDate" id="inputStrDate" style="height: 2rem">
                              </div>
                            </div>-->
                            <div class="col-lg-2 col-2">
                                <div class="input-group shadow-none">
                                    <label style="font-size: 0.85rem; width: 4rem"><i class="fas fa-search me-2"></i>결재자</label>
                                    <input readonly class="form-control border border-light rounded-1 text-center me-2" type="text" name="inputEpno" id="inputEpno" style="height: 2rem">
                                </div>
                            </div>
                            <div class="col-lg-2 col-2">
                                <div class="input-group shadow-none">
                                    <label style="font-size: 0.85rem; width: 4rem"><i class="fas fa-search me-2"></i>구분</label>
                                    <select class="form-control border border-light rounded-1 text-center p-0" name="inputGbn" id="inputGbn" style="font-size: 0.8rem; height: 2rem">
                                        <option value="1">전체</option>
                                        <option value="2">미결재</option>
                                        <option value="3">결재</option>
                                        <option value="4">미승인</option>
                                        <option value="5">승인</option>
                                    </select>
                                </div>
                            </div>
                            <!--<div class="col-lg-5 col-5 text-start">
                                 <button type="button" class="btn btn-sm bg-gradient-info" id="btnSearch" name="btnSearch"><i class="fas fa-search me-2"></i>조회</button>
                            </div>-->
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-lg-6 col-6">
                                <div class="table-responsive-sm height-400 overflow-auto border border-light">
                                  <table class="table mb-0 align-items-center justify-content-center">
                                      <colgroup>
                                          <col width="8%">
                                          <col width="15%">
                                          <col width="10%">
                                          <col width="6%">
                                          <col width="4%">
                                          <col width="4%">
                                      </colgroup>
                                    <thead class="text-white font-weight-bolder text-center bg-primary">
                                      <tr>
                                        <th style="font-size: 0.85rem" class="p-0">작성일자</th>
                                        <th style="font-size: 0.85rem" class="p-0">제 목</th>
                                        <th style="font-size: 0.85rem" class="p-0">지출금액</th>
                                        <th style="font-size: 0.85rem" class="p-0">작성자</th>
                                        <th style="font-size: 0.85rem" class="p-0">결재</th>
                                        <th style="font-size: 0.85rem" class="p-0">승인</th>
                                      </tr>
                                    </thead>
                                    <tbody id="mainTb">
                                      <tr id="#mainTr" class="mainTr_tr">

                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                                <div class="table-responsive-sm overflow-auto border border-light">
                                    <table class="table mb-0 align-items-center justify-content-center">
                                        <colgroup>
                                            <col width="8%">
                                            <col width="8%">
                                            <col width="8%">
                                            <col width="8%">
                                            <col width="8%">
                                        </colgroup>
                                      <thead class="text-white font-weight-bolder text-center bg-warning">
                                        <tr>
                                          <th style="font-size: 0.85rem" class="border border-white p-2" id="btnChoice" data-bs-toggle='modal' data-bs-target='#DecisionModal'>이순신</th>
                                          <th style="font-size: 0.85rem" class="border border-white p-2" id="btnChoice" data-bs-toggle='modal' data-bs-target='#DecisionModal'>강감찬</th>
                                          <th style="font-size: 0.85rem" class="border border-white p-2" id="btnChoice" data-bs-toggle='modal' data-bs-target='#DecisionModal'>정몽주</th>
                                          <th style="font-size: 0.85rem" class="border border-white p-2" id="btnChoice" data-bs-toggle='modal' data-bs-target='#DecisionModal'>김좌진</th>
                                          <th style="font-size: 0.85rem" class="border border-white p-2" id="btnChoice" data-bs-toggle='modal' data-bs-target='#DecisionModal'>홍범도</th>
                                        </tr>
                                      </thead>
                                      <tbody id="subTb">
                                        <tr id="#subTr" class="subTr_tr">
                                            <td class="border border-end border-light" style="height: 5vh"></td>
                                            <td class="border border-end border-light" style="height: 5vh"></td>
                                            <td class="border border-end border-light" style="height: 5vh"></td>
                                            <td class="border border-end border-light" style="height: 5vh"></td>
                                            <td class="border border-end border-light" style="height: 5vh"></td>
                                        </tr>
                                      </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="col-lg-6 col-6">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="DecisionModal" tabindex="-1" role="dialog" aria-labelledby="DecisionModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document" style="min-width: 30vw">
            <div class="modal-content">
                <form method="post">
                    {% csrf_token %}
                    <div class="modal-header bg-dark" style="height: 5vh">
                        <h6 class="text-white font-weight-bold mt-2"><i class="fas fa-credit-card fas-4 me-3"></i>결재 승인</h6>
                        <button class="btn btn-close border border-white"><i class="fas fa-xmark"></i></button>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <div class="row p-0">
                                <div class="col-4 text-start">
                                    <button class="btn btn-sm btn-primary" id="btnApv" name="btnApv"><i class="ni ni-bold-down pe-3"></i>결 재</button>
                                </div>
                            </div>
                            <div class="row p-0">
                                <div class="col-4 text-start">
                                    <button class="btn btn-sm btn-primary" id="btnAbt" name="btnAbt"><i class="ni ni-bold-down pe-3"></i>전 결</button>
                                </div>
                            </div>
                            <div class="row p-0">
                                <div class="col-4 text-start">
                                    <button class="btn btn-sm btn-primary" id="btnReturn" name="btnReturn"><i class="ni ni-bold-down pe-3"></i>반 려</button>
                                </div>
                            </div>
                            <div class="row p-0">
                                <div class="col-12 text-start">
                                    <div class="form-group">
                                        <label class="mt-2 text-sm">반려 사유</label>
                                        <input class="form-control" type="text" style="height: 2rem; font-size: 0.85rem"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!--<div class="col-lg-8 col-8 mb-md-0">
        <div class="card border border-white shadow-xs">
            <div class="row p-0">
                <div class="col-lg-6 col-6">
                    <div class="card-body">
                        <label class="mt-2 form-label"><i class="fas fa-image me-2"></i>증빙서류 등록</label>
                        <form action="/file-upload" class="form-control dropzone" id="dropzone">
                          <div class="fallback">
                            <input name="file" id="file" type="file" multiple class="height-500"/>
                          </div>
                        </form>
                        <div class="form-group text-end mt-3">
                            <a class="btn btn-linkedin btn-sm" type="button" id="btnImgSave">사진등록</a>
                            <a class="btn btn-outline-dark btn-sm" type="button" id="btnImgDlt">사진 초기화</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>-->

    <!--<div class="form-group">
    <div class="row">
        <div class="col-12">
            <label class="mt-2 text-sm"><i class="far fa-edit me-2"></i>제 목</label>
            <input class="form-control text-end" type="text" id="txtTitle" name="txtTitle" style="height: 2rem; font-size: 0.8rem"/>
        </div>
    </div>
    <div class="row">
        <div class="col-6">
            <label class="mt-2 text-sm"><i class="far fa-calendar me-2"></i>작성 일자</label>
            <input class="form-control text-center" type="date" id="txtRegDate" name="txtRegDate" style="height: 2rem; font-size: 0.8rem"/>
        </div>
        <div class="col-6">
            <label class="mt-2 text-sm"><i class="far fa-calendar me-2"></i>결재 일자</label>
            <input class="form-control text-center" type="date" id="txtApvDate" name="txtApvDate" style="height: 2rem; font-size: 0.8rem"/>
        </div>
    </div>
    <div class="row">
        <div class="col-6">
            <label class="mt-2 text-sm"><i class="far fa-calendar me-2"></i>지출 금액</label>
            <input class="form-control text-center" type="number" id="txtRegDate" name="txtRegDate" style="height: 2rem; font-size: 0.8rem"/>
        </div>
        <div class="col-6">
            <label class="mt-2 text-sm"><i class="far fa-calendar me-2"></i>작성자</label>
            <input readonly class="form-control text-center bg-transparent" type="text" id="txtApvDate" name="txtApvDate" style="height: 2rem; font-size: 0.8rem"/>
        </div>
    </div>
    <div class="row">
        <div class="col-6">
            <label class="mt-2 text-sm"><i class="fas fa-edit me-2"></i>결재계좌</label>
            <select class="form-control border border-light rounded-1 text-center p-1" name="cboWitActNum" id="cboWitActNum" style="height: 2rem; font-size: 0.8rem"></select>
        </div>
    </div>
</div>
<div class="table-responsive-sm overflow-auto border border-light height-200">
  <table class="table mb-0 align-items-center justify-content-center">
      <colgroup>
          <col width="12%">
          <col width="8%">
          <col width="15%">
      </colgroup>
    <thead class="text-white font-weight-bolder text-center" style="background-color: rgb(0, 92, 151);">
      <tr>
        <th style="font-size: 0.85rem" class="p-0">항 목</th>
        <th style="font-size: 0.85rem" class="p-0">금 액</th>
        <th style="font-size: 0.85rem" class="p-0">비 고</th>
      </tr>
    </thead>
    <tbody id="mainTb">
      <tr id="#mainTr" class="mainTr_tr">

      </tr>
    </tbody>
  </table>
</div>
<div class="form-group mt-2 mb-0">
    <div class="row">
        <div class="col-12 text-start">
            <button class="btn btn-sm btn-dark" id="btnDst" name="btnDst" data-bs-toggle='modal' data-bs-target='#sendModal'>결재선 지정</button>
        </div>
    </div>
</div>-->




{% endblock %}

{% block javascripts %}
    <script>
        $(document).ready(function () {

            var gbn = document.getElementById('inputGbn').value

            let data = {'gbn': gbn}

            $.ajax({
                type: "post",
                data: data,
                url: '{% url "approval_reg_search" %}',
                headers: {
                    'X-CSRFTOKEN': '{{ csrf_token }}'
                },
                dataType: 'json',
                success: function (data) {
                    var list = data.mainList;

                    $("#mainTb").html("");
                    for (var i = 0; i < list.length; i++) {
                        $("#mainTb").append(
                            "<tr id='#mainTr' class='mainTr_tr'>" +
                            "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][0] + "</td> " +
                            "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][1] + "</td> " +
                            "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][2] + "</td> " +
                            "<td class='text-start p-1' style='font-size: 0.85rem'>" + list[i][3] + "</td> " +
                            "<td class='text-start p-1' style='font-size: 0.85rem'>미결재</td> " +
                            "<td class='text-center p-1' style='font-size: 0.85rem'><div class='form-check text-xs'><input class='form-check-input' type='checkbox' id='chkApv[]' name='chkApv[]' value='" + list[i][0] + "," + list[i][2] + "," + list[i][4] + "'/></div></td> " +
                            "</tr> ");
                    }
                }
            })

        });

        {# 구분 콤보박스 클릭시 #}
        $('#inputGbn').change(function () {

        });

    </script>

    <script>
        $(document).on('click', '#btnDecide', function () {

            $('#DecisionModal').show();
        });
    </script>
{% endblock %}